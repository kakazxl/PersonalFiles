# ç²¾å°½ RocketMQ é¢è¯•é¢˜



ä»¥ä¸‹é¢è¯•é¢˜ï¼ŒåŸºäºç½‘ç»œæ•´ç†ï¼Œå’Œè‡ªå·±ç¼–è¾‘ã€‚å…·ä½“å‚è€ƒçš„æ–‡ç« ï¼Œä¼šåœ¨æ–‡æœ«ç»™å‡ºæ‰€æœ‰çš„é“¾æ¥ã€‚

å¦‚æœèƒ–å‹æœ‰è‡ªå·±çš„ç–‘é—®ï¼Œæ¬¢è¿åœ¨æ˜Ÿçƒæé—®ï¼Œæˆ‘ä»¬ä¸€èµ·æ•´ç†åŠåŠçš„ RocketMQ çš„å¤§ä¿å¥ã€‚

è€Œé¢˜ç›®çš„éš¾åº¦ï¼Œè‰¿è‰¿å°½é‡æŒ‰ç…§ä»å®¹æ˜“åˆ°å›°éš¾çš„é¡ºåºï¼Œé€æ­¥ä¸‹å»ã€‚

> å‹æƒ…æç¤ºï¼šåœ¨å¼€å§‹é˜…è¯»ä¹‹å‰ï¼Œèƒ–å‹è‡³å°‘å¯¹ [ã€ŠRocketMQ â€”â€” è§’è‰²ä¸æœ¯è¯­è¯¦è§£ã€‹](http://jaskey.github.io/blog/2016/12/15/rocketmq-concept/) æœ‰ç®€å•çš„äº†è§£ã€‚

å¦å¤–ï¼Œè¿™ä¸ªé¢è¯•é¢˜æ˜¯å»ºç«‹åœ¨èƒ–å‹çœ‹è¿‡ [ã€Šç²¾å°½ã€æ¶ˆæ¯é˜Ÿåˆ— ã€‘é¢è¯•é¢˜ã€‹](http://svip.iocoder.cn/MQ/Interview) ã€‚

## RocketMQ æ˜¯ä»€ä¹ˆï¼Ÿ

RocketMQ æ˜¯é˜¿é‡Œå·´å·´åœ¨ 2012 å¹´å¼€æºçš„åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œç›®å‰å·²ç»æèµ ç»™ Apache è½¯ä»¶åŸºé‡‘ä¼šï¼Œå¹¶äº 2017 å¹´ 9 æœˆ 25 æ—¥æˆä¸º Apache çš„é¡¶çº§é¡¹ç›®ã€‚ä½œä¸ºç»å†è¿‡å¤šæ¬¡é˜¿é‡Œå·´å·´åŒåä¸€è¿™ç§â€œè¶…çº§å·¥ç¨‹â€çš„æ´—ç¤¼å¹¶æœ‰ç¨³å®šå‡ºè‰²è¡¨ç°çš„å›½äº§ä¸­é—´ä»¶ï¼Œä»¥å…¶é«˜æ€§èƒ½ã€ä½å»¶æ—¶å’Œé«˜å¯é ç­‰ç‰¹æ€§è¿‘å¹´æ¥å·²ç»ä¹Ÿè¢«è¶Šæ¥è¶Šå¤šçš„å›½å†…ä¼ä¸šä½¿ç”¨ã€‚

------

å¦‚ä¸‹æ˜¯ RocketMQ äº§ç”Ÿçš„åŸå› ï¼š

> æ·˜å®å†…éƒ¨çš„äº¤æ˜“ç³»ç»Ÿä½¿ç”¨äº†æ·˜å®è‡ªä¸»ç ”å‘çš„ Notify æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œä½¿ç”¨ MySQL ä½œä¸ºæ¶ˆæ¯å­˜å‚¨åª’ä»‹ï¼Œå¯å®Œå…¨æ°´å¹³æ‰©å®¹ï¼Œä¸ºäº†è¿›ä¸€æ­¥é™ä½æˆæœ¬ï¼Œæˆ‘ä»¬è®¤ä¸ºå­˜å‚¨éƒ¨åˆ†å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œ2011 å¹´åˆï¼ŒLinkinå¼€æºäº† Kafka è¿™ä¸ªä¼˜ç§€çš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œæ·˜å®ä¸­é—´ä»¶å›¢é˜Ÿåœ¨å¯¹ Kafka åšè¿‡å……åˆ† Review ä¹‹åï¼Œ Kafka æ— é™æ¶ˆæ¯å †ç§¯ï¼Œé«˜æ•ˆçš„æŒä¹…åŒ–é€Ÿåº¦å¸å¼•äº†æˆ‘ä»¬ï¼Œä½†æ˜¯åŒæ—¶å‘ç°è¿™ä¸ªæ¶ˆæ¯ç³»ç»Ÿä¸»è¦å®šä½äºæ—¥å¿—ä¼ è¾“ï¼Œå¯¹äºä½¿ç”¨åœ¨æ·˜å®äº¤æ˜“ã€è®¢å•ã€å……å€¼ç­‰åœºæ™¯ä¸‹è¿˜æœ‰è¯¸å¤šç‰¹æ€§ä¸æ»¡è¶³ï¼Œä¸ºæ­¤æˆ‘ä»¬é‡æ–°ç”¨ Java è¯­è¨€ç¼–å†™äº† RocketMQ ï¼Œå®šä½äºéæ—¥å¿—çš„å¯é æ¶ˆæ¯ä¼ è¾“ï¼ˆæ—¥å¿—åœºæ™¯ä¹ŸOKï¼‰ï¼Œç›®å‰ RocketMQ åœ¨é˜¿é‡Œé›†å›¢è¢«å¹¿æ³›åº”ç”¨åœ¨è®¢å•ï¼Œäº¤æ˜“ï¼Œå……å€¼ï¼Œæµè®¡ç®—ï¼Œæ¶ˆæ¯æ¨é€ï¼Œæ—¥å¿—æµå¼å¤„ç†ï¼Œ binglog åˆ†å‘ç­‰åœºæ™¯ã€‚

## RocketMQ ç”±å“ªäº›è§’è‰²ç»„æˆï¼Ÿ

å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š![RocketMQ è§’è‰²](http://static.iocoder.cn/images/RocketMQ/2019_11_12/01.png)

- ç”Ÿäº§è€…ï¼ˆProducerï¼‰ï¼šè´Ÿè´£äº§ç”Ÿæ¶ˆæ¯ï¼Œç”Ÿäº§è€…å‘æ¶ˆæ¯æœåŠ¡å™¨å‘é€ç”±ä¸šåŠ¡åº”ç”¨ç¨‹åºç³»ç»Ÿç”Ÿæˆçš„æ¶ˆæ¯ã€‚
- æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰ï¼šè´Ÿè´£æ¶ˆè´¹æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ä»æ¶ˆæ¯æœåŠ¡å™¨æ‹‰å–ä¿¡æ¯å¹¶å°†å…¶è¾“å…¥ç”¨æˆ·åº”ç”¨ç¨‹åºã€‚
- æ¶ˆæ¯æœåŠ¡å™¨ï¼ˆBrokerï¼‰ï¼šæ˜¯æ¶ˆæ¯å­˜å‚¨ä¸­å¿ƒï¼Œä¸»è¦ä½œç”¨æ˜¯æ¥æ”¶æ¥è‡ª Producer çš„æ¶ˆæ¯å¹¶å­˜å‚¨ï¼Œ Consumer ä»è¿™é‡Œå–å¾—æ¶ˆæ¯ã€‚
- åç§°æœåŠ¡å™¨ï¼ˆNameServerï¼‰ï¼šç”¨æ¥ä¿å­˜ Broker ç›¸å…³ Topic ç­‰å…ƒä¿¡æ¯å¹¶ç»™ Producer ï¼Œæä¾› Consumer æŸ¥æ‰¾ Broker ä¿¡æ¯ã€‚

## è¯·æè¿°ä¸‹ RocketMQ çš„æ•´ä½“æµç¨‹ï¼Ÿ

![æ•´ä½“æµç¨‹](http://static.iocoder.cn/images/RocketMQ/2019_11_12/02.png)

- 1ã€å¯åŠ¨ **Namesrv**ï¼ŒNamesrvèµ· æ¥åç›‘å¬ç«¯å£ï¼Œç­‰å¾… Brokerã€Producerã€Consumer è¿ä¸Šæ¥ï¼Œç›¸å½“äºä¸€ä¸ªè·¯ç”±æ§åˆ¶ä¸­å¿ƒã€‚

- 2ã€**Broker** å¯åŠ¨ï¼Œè·Ÿæ‰€æœ‰çš„ Namesrv ä¿æŒé•¿è¿æ¥ï¼Œå®šæ—¶å‘é€å¿ƒè·³åŒ…ã€‚

  > å¿ƒè·³åŒ…ä¸­ï¼ŒåŒ…å«å½“å‰ Broker ä¿¡æ¯(IP+ç«¯å£ç­‰)ä»¥åŠå­˜å‚¨æ‰€æœ‰ Topic ä¿¡æ¯ã€‚
  > æ³¨å†ŒæˆåŠŸåï¼ŒNamesrv é›†ç¾¤ä¸­å°±æœ‰ Topic è·Ÿ Broker çš„æ˜ å°„å…³ç³»ã€‚

  - 3ã€æ”¶å‘æ¶ˆæ¯å‰ï¼Œå…ˆåˆ›å»º Topic ã€‚åˆ›å»º Topic æ—¶ï¼Œéœ€è¦æŒ‡å®šè¯¥ Topic è¦å­˜å‚¨åœ¨ å“ªäº› Brokerä¸Šã€‚ä¹Ÿå¯ä»¥åœ¨å‘é€æ¶ˆæ¯æ—¶è‡ªåŠ¨åˆ›å»ºTopicã€‚

- 4ã€**Producer** å‘é€æ¶ˆæ¯ã€‚

  > å¯åŠ¨æ—¶ï¼Œå…ˆè·Ÿ Namesrv é›†ç¾¤ä¸­çš„å…¶ä¸­ä¸€å°å»ºç«‹é•¿è¿æ¥ï¼Œå¹¶ä»Namesrv ä¸­è·å–å½“å‰å‘é€çš„ Topic å­˜åœ¨å“ªäº› Broker ä¸Šï¼Œç„¶åè·Ÿå¯¹åº”çš„ Broker å»ºç«‹é•¿è¿æ¥ï¼Œç›´æ¥å‘ Broker å‘æ¶ˆæ¯ã€‚

- 5ã€**Consumer** æ¶ˆè´¹æ¶ˆæ¯ã€‚

  > Consumer è·Ÿ Producer ç±»ä¼¼ã€‚è·Ÿå…¶ä¸­ä¸€å° Namesrv å»ºç«‹é•¿è¿æ¥ï¼Œè·å–å½“å‰è®¢é˜… Topic å­˜åœ¨å“ªäº› Broker ä¸Šï¼Œç„¶åç›´æ¥è·Ÿ Broker å»ºç«‹è¿æ¥é€šé“ï¼Œå¼€å§‹æ¶ˆè´¹æ¶ˆæ¯ã€‚

------

> è‰¿è‰¿ï¼šä¸‹é¢ï¼Œæˆ‘ä»¬å…ˆé€æ­¥å¯¹ RocketMQ æ¯ä¸ªè§’è‰²è¿›è¡Œä»‹ç»ã€‚
>
> å¯¹ä¸äº†è§£ RocketMQ çš„èƒ–å‹æ¥è¯´ï¼Œå¯èƒ½æ¦‚å¿µä¼šæœ‰ç‚¹å¤šã€‚æ·¡å®š~

## è¯·è¯´è¯´ä½ å¯¹ Namesrv çš„äº†è§£ï¼Ÿ

- 1ã€ Namesrv ç”¨äºå­˜å‚¨ Topicã€Broker å…³ç³»ä¿¡æ¯ï¼ŒåŠŸèƒ½ç®€å•ï¼Œç¨³å®šæ€§é«˜ã€‚

  - å¤šä¸ª Namesrv ä¹‹é—´ç›¸äº’æ²¡æœ‰é€šä¿¡ï¼Œå•å° Namesrv å®•æœºä¸å½±å“å…¶å®ƒ Namesrv ä¸é›†ç¾¤ã€‚

    > å¤šä¸ª Namesrv ä¹‹é—´çš„ä¿¡æ¯å…±äº«ï¼Œ**é€šè¿‡ Broker ä¸»åŠ¨å‘å¤šä¸ª Namesrv éƒ½å‘èµ·å¿ƒè·³**ã€‚æ­£å¦‚ä¸Šæ–‡æ‰€è¯´ï¼ŒBroker éœ€è¦è·Ÿæ‰€æœ‰ Namesrv è¿æ¥ã€‚

  - å³ä½¿æ•´ä¸ª Namesrv é›†ç¾¤å®•æœºï¼Œå·²ç»æ­£å¸¸å·¥ä½œçš„ Producerã€Consumerã€Broker ä»ç„¶èƒ½æ­£å¸¸å·¥ä½œï¼Œä½†æ–°èµ·çš„ Producerã€Consumerã€Broker å°±æ— æ³•å·¥ä½œã€‚

    > è¿™ç‚¹å’Œ Dubbo æœ‰äº›ä¸åŒï¼Œä¸ä¼šç¼“å­˜ Topic ç­‰å…ƒä¿¡æ¯åˆ°æœ¬åœ°æ–‡ä»¶ã€‚

- 2ã€ Namesrv å‹åŠ›ä¸ä¼šå¤ªå¤§ï¼Œå¹³æ—¶ä¸»è¦å¼€é”€æ˜¯åœ¨ç»´æŒå¿ƒè·³å’Œæä¾› Topic-Broker çš„å…³ç³»æ•°æ®ã€‚ä½†æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼ŒBroker å‘ Namesr å‘å¿ƒè·³æ—¶ï¼Œä¼šå¸¦ä¸Šå½“å‰è‡ªå·±æ‰€è´Ÿè´£çš„æ‰€æœ‰ Topic ä¿¡æ¯ï¼Œå¦‚æœ Topic ä¸ªæ•°å¤ªå¤šï¼ˆä¸‡çº§åˆ«ï¼‰ï¼Œä¼šå¯¼è‡´ä¸€æ¬¡å¿ƒè·³ä¸­ï¼Œå°± Topic çš„æ•°æ®å°±å‡ å Mï¼Œç½‘ç»œæƒ…å†µå·®çš„è¯ï¼Œç½‘ç»œä¼ è¾“å¤±è´¥ï¼Œå¿ƒè·³å¤±è´¥ï¼Œå¯¼è‡´ Namesrv è¯¯è®¤ä¸º Broker å¿ƒè·³å¤±è´¥ã€‚

  > å½“ç„¶ï¼Œä¸€èˆ¬å…¬å¸ï¼Œå¾ˆéš¾è¾¾åˆ°è¿‡ä¸‡çº§çš„ Topic ï¼Œå› ä¸ºä¸€æ–¹é¢ä½“é‡è¾¾ä¸åˆ°ï¼Œå¦ä¸€æ–¹é¢ RocketMQ æä¾›äº† Tag å±æ€§ã€‚
  >
  > å¦å¤–ï¼Œå†…ç½‘ç¯å¢ƒç½‘ç»œç›¸å¯¹æ˜¯æ¯”è¾ƒç¨³å®šçš„ï¼Œä¼ è¾“å‡ å M é—®é¢˜ä¸å¤§ã€‚åŒæ—¶ï¼Œå¦‚æœçœŸçš„è¦ä¼˜åŒ–ï¼ŒBroker å¯ä»¥æŠŠå¿ƒè·³åŒ…åšå‹ç¼©ï¼Œå†å‘é€ç»™ Namesrv ã€‚ä¸è¿‡ï¼Œè¿™æ ·ä¹Ÿä¼šå¸¦æ¥ CPU çš„å ç”¨ç‡çš„æå‡ã€‚

## å¦‚ä½•é…ç½® Namesrv åœ°å€åˆ°ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼Ÿ

å°† Namesrv åœ°å€åˆ—è¡¨æä¾›ç»™å®¢æˆ·ç«¯( ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€… )ï¼Œæœ‰å››ç§æ–¹æ³•ï¼š

- ç¼–ç¨‹æ–¹å¼ï¼Œå°±åƒ `producer.setNamesrvAddr("ip:port")` ã€‚
- Java å¯åŠ¨å‚æ•°è®¾ç½®ï¼Œä½¿ç”¨ `rocketmq.namesrv.addr` ã€‚
- ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨ `NAMESRV_ADDR` ã€‚
- HTTP ç«¯ç‚¹ï¼Œä¾‹å¦‚è¯´ï¼š`http://namesrv.rocketmq.xxx.com` åœ°å€ï¼Œé€šè¿‡ DNS è§£æè·å¾— Namesrv çœŸæ­£çš„åœ°å€ã€‚

## è¯·è¯´è¯´ä½ å¯¹ Broker çš„äº†è§£ï¼Ÿ

- 1ã€ **é«˜å¹¶å‘è¯»å†™æœåŠ¡**ã€‚Brokerçš„é«˜å¹¶å‘è¯»å†™ä¸»è¦æ˜¯ä¾é ä»¥ä¸‹ä¸¤ç‚¹ï¼š

  - æ¶ˆæ¯é¡ºåºå†™ï¼Œæ‰€æœ‰ Topic æ•°æ®åŒæ—¶åªä¼šå†™ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ–‡ä»¶æ»¡1G ï¼Œå†å†™æ–°æ–‡ä»¶ï¼ŒçœŸæ­£çš„é¡ºåºå†™ç›˜ï¼Œä½¿å¾—å‘æ¶ˆæ¯ TPS å¤§å¹…æé«˜ã€‚
  - æ¶ˆæ¯éšæœºè¯»ï¼ŒRocketMQ å°½å¯èƒ½è®©è¯»å‘½ä¸­ç³»ç»Ÿ Pagecache ï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿè®¿é—® Pagecache æ—¶ï¼Œå³ä½¿åªè®¿é—® 1K çš„æ¶ˆæ¯ï¼Œç³»ç»Ÿä¹Ÿä¼šæå‰é¢„è¯»å‡ºæ›´å¤šçš„æ•°æ®ï¼Œåœ¨ä¸‹æ¬¡è¯»æ—¶å°±å¯èƒ½å‘½ä¸­ Pagecache ï¼Œå‡å°‘ IO æ“ä½œã€‚

- 2ã€ **è´Ÿè½½å‡è¡¡ä¸åŠ¨æ€ä¼¸ç¼©**ã€‚

  - è´Ÿè½½å‡è¡¡ï¼šBroker ä¸Šå­˜ Topic ä¿¡æ¯ï¼ŒTopic ç”±å¤šä¸ªé˜Ÿåˆ—ç»„æˆï¼Œé˜Ÿåˆ—ä¼šå¹³å‡åˆ†æ•£åœ¨å¤šä¸ª Broker ä¸Šï¼Œè€Œ Producer çš„å‘é€æœºåˆ¶ä¿è¯æ¶ˆæ¯å°½é‡å¹³å‡åˆ†å¸ƒåˆ°æ‰€æœ‰é˜Ÿåˆ—ä¸­ï¼Œæœ€ç»ˆæ•ˆæœå°±æ˜¯æ‰€æœ‰æ¶ˆæ¯éƒ½å¹³å‡è½åœ¨æ¯ä¸ª Broker ä¸Šã€‚

  - åŠ¨æ€ä¼¸ç¼©èƒ½åŠ›ï¼ˆéé¡ºåºæ¶ˆæ¯ï¼‰ï¼šBroker çš„ä¼¸ç¼©æ€§ä½“ç°åœ¨ä¸¤ä¸ªç»´åº¦ï¼šTopicã€Brokerã€‚

    - Topic ç»´åº¦ï¼šå‡å¦‚ä¸€ä¸ª Topic çš„æ¶ˆæ¯é‡ç‰¹åˆ«å¤§ï¼Œä½†é›†ç¾¤æ°´ä½å‹åŠ›è¿˜æ˜¯å¾ˆä½ï¼Œå°±å¯ä»¥æ‰©å¤§è¯¥ Topic çš„é˜Ÿåˆ—æ•°ï¼Œ Topic çš„é˜Ÿåˆ—æ•°è·Ÿå‘é€ã€æ¶ˆè´¹é€Ÿåº¦æˆæ­£æ¯”ã€‚

      > Topic çš„é˜Ÿåˆ—æ•°ä¸€æ—¦æ‰©å¤§ï¼Œå°±æ— æ³•å¾ˆæ–¹ä¾¿çš„ç¼©å°ã€‚å› ä¸ºï¼Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…éƒ½æ˜¯åŸºäºç›¸åŒçš„é˜Ÿåˆ—æ•°æ¥å¤„ç†ã€‚
      > å¦‚æœçœŸçš„æƒ³è¦ç¼©å°ï¼Œåªèƒ½æ–°å»ºä¸€ä¸ª Topic ï¼Œç„¶åä½¿ç”¨å®ƒã€‚
      > ä¸è¿‡ï¼ŒTopic çš„é˜Ÿåˆ—æ•°ï¼Œä¹Ÿä¸å­˜åœ¨ä»€ä¹ˆå½±å“çš„ï¼Œæ·¡å®šã€‚

    - Broker ç»´åº¦ï¼šå¦‚æœé›†ç¾¤æ°´ä½å¾ˆé«˜äº†ï¼Œéœ€è¦æ‰©å®¹ï¼Œç›´æ¥åŠ æœºå™¨éƒ¨ç½² Broker å°±å¯ä»¥ã€‚Broker å¯åŠ¨åå‘ Namesrv æ³¨å†Œï¼ŒProducerã€Consumer é€šè¿‡ Namesrv å‘ç°æ–°Brokerï¼Œç«‹å³è·Ÿè¯¥ Broker ç›´è¿ï¼Œæ”¶å‘æ¶ˆæ¯ã€‚

      > æ–°å¢çš„ Broker æƒ³è¦ä¸‹çº¿ï¼Œæƒ³è¦ä¸‹çº¿ä¹Ÿæ¯”è¾ƒéº»çƒ¦ï¼Œæš‚æ—¶æ²¡ç‰¹åˆ«å¥½çš„æ–¹æ¡ˆã€‚å¤§ä½“çš„å‰ææ˜¯ï¼Œæ¶ˆè´¹è€…æ¶ˆè´¹å®Œè¯¥ Broker çš„æ¶ˆæ¯ï¼Œç”Ÿäº§è€…ä¸å¾€è¿™ä¸ª Broker å‘é€æ¶ˆæ¯ã€‚

- 3ã€ **é«˜å¯ç”¨ & é«˜å¯é **ã€‚

  - é«˜å¯ç”¨ï¼šé›†ç¾¤éƒ¨ç½²æ—¶ä¸€èˆ¬éƒ½ä¸ºä¸»å¤‡ï¼Œå¤‡æœºå®æ—¶ä»ä¸»æœºåŒæ­¥æ¶ˆæ¯ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªä¸»æœºå®•æœºï¼Œå¤‡æœºæä¾›æ¶ˆè´¹æœåŠ¡ï¼Œä½†ä¸æä¾›å†™æœåŠ¡ã€‚

  - é«˜å¯é ï¼šæ‰€æœ‰å‘å¾€ Broker çš„æ¶ˆæ¯ï¼Œæœ‰åŒæ­¥åˆ·ç›˜å’Œå¼‚æ­¥åˆ·ç›˜æœºåˆ¶ã€‚

    - åŒæ­¥åˆ·ç›˜æ—¶ï¼Œæ¶ˆæ¯å†™å…¥ç‰©ç†æ–‡ä»¶æ‰ä¼šè¿”å›æˆåŠŸã€‚

    - å¼‚æ­¥åˆ·ç›˜æ—¶ï¼Œåªæœ‰æœºå™¨å®•æœºï¼Œæ‰ä¼šäº§ç”Ÿæ¶ˆæ¯ä¸¢å¤±ï¼ŒBroker æŒ‚æ‰å¯èƒ½ä¼šå‘ç”Ÿï¼Œä½†æ˜¯æœºå™¨å®•æœºå´©æºƒæ˜¯å¾ˆå°‘å‘ç”Ÿçš„ï¼Œé™¤éçªç„¶æ–­ç”µã€‚

      > å¦‚æœ Broker æŒ‚æ‰ï¼ŒæœªåŒæ­¥åˆ°ç¡¬ç›˜çš„æ¶ˆæ¯ï¼Œè¿˜åœ¨ Pagecache ä¸­å‘†ç€ã€‚

- 4ã€ **Broker ä¸ Namesrv çš„å¿ƒè·³æœºåˆ¶**ã€‚

  - å•ä¸ª Broker è·Ÿæ‰€æœ‰ Namesrv ä¿æŒå¿ƒè·³è¯·æ±‚ï¼Œå¿ƒè·³é—´éš”ä¸º30ç§’ï¼Œå¿ƒè·³è¯·æ±‚ä¸­åŒ…æ‹¬å½“å‰ Broker æ‰€æœ‰çš„ Topic ä¿¡æ¯ã€‚
  - Namesrv ä¼šåæŸ¥ Broker çš„å¿ƒè·³ä¿¡æ¯ï¼Œå¦‚æœæŸä¸ª Broker åœ¨ 2 åˆ†é’Ÿä¹‹å†…éƒ½æ²¡æœ‰å¿ƒè·³ï¼Œåˆ™è®¤ä¸ºè¯¥ Broker ä¸‹çº¿ï¼Œè°ƒæ•´ Topic è·Ÿ Broker çš„å¯¹åº”å…³ç³»ã€‚ä½†æ­¤æ—¶ Namesrv ä¸ä¼šä¸»åŠ¨é€šçŸ¥Producerã€Consumer æœ‰ Broker å®•æœºã€‚ä¹Ÿå°±è¯´ï¼Œåªèƒ½ç­‰ Producerã€Consumer ä¸‹æ¬¡å®šæ—¶æ‹‰å– Topic ä¿¡æ¯çš„æ—¶å€™ï¼Œæ‰ä¼šå‘ç°æœ‰ Broker å®•æœºã€‚

ä»ä¸Šé¢çš„æè¿°ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå·²ç»å‘ç° Broker æ˜¯ RocketMQ ä¸­æœ€æœ€æœ€å¤æ‚çš„è§’è‰²ï¼Œä¸»è¦åŒ…æ‹¬å¦‚ä¸‹äº”ä¸ªæ¨¡å—ï¼š

[Broker ç»„ä»¶å›¾](https://ws1.sinaimg.cn/large/006tKfTcgy1fo4vbpoxtej30r30dsdgs.jpg)

- è¿œç¨‹å¤„ç†æ¨¡å—ï¼šæ˜¯ Broker çš„å…¥å£ï¼Œå¤„ç†æ¥è‡ªå®¢æˆ·çš„è¯·æ±‚ã€‚
- Client Manager ï¼šç®¡ç†å®¢æˆ·ç«¯ï¼ˆç”Ÿäº§è€…/æ¶ˆè´¹è€…ï¼‰ï¼Œå¹¶ç»´æŠ¤æ¶ˆè´¹è€…çš„ä¸»é¢˜è®¢é˜…ã€‚
- Store Service ï¼šæä¾›ç®€å•çš„ API æ¥å­˜å‚¨æˆ–æŸ¥è¯¢ç‰©ç†ç£ç›˜ä¸­çš„æ¶ˆæ¯ã€‚
- HA æœåŠ¡ï¼šæä¾›ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®åŒæ­¥åŠŸèƒ½ã€‚
- ç´¢å¼•æœåŠ¡ï¼šé€šè¿‡æŒ‡å®šé”®ä¸ºæ¶ˆæ¯å»ºç«‹ç´¢å¼•ï¼Œå¹¶æä¾›å¿«é€Ÿçš„æ¶ˆæ¯æŸ¥è¯¢ã€‚

## Broker å¦‚ä½•å®ç°æ¶ˆæ¯çš„å­˜å‚¨ï¼Ÿ

å…³äº Broker å¦‚ä½•å®ç°æ¶ˆæ¯çš„å­˜å‚¨ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„è¯é¢˜ï¼Œæ‰€ä»¥è‰¿è‰¿å»ºè®®ç›´æ¥çœ‹å¦‚ä¸‹çš„èµ„æ–™ï¼Œä¿æŒè€å¿ƒã€‚

- ã€Šè¯»æ‡‚è¿™ç¯‡æ–‡ç« ï¼Œä½ çš„é˜¿é‡ŒæŠ€æœ¯é¢å°±å¯ä»¥è¿‡å…³äº† | Apache RocketMQã€‹

   

  çš„å¦‚ä¸‹éƒ¨åˆ†ï¼š

  - [ã€Œä¸‰ã€RocketMQçš„å­˜å‚¨æ¨¡å‹ã€](http://svip.iocoder.cn/RocketMQ/Interview/#)

- ã€ŠRocketMQ åŸç†ç®€ä»‹ã€‹

   

  çš„å¦‚ä¸‹éƒ¨åˆ†ï¼š

  - [ã€Œ6.3 æ•°æ®å­˜å‚¨ç»“æ„ã€](http://svip.iocoder.cn/RocketMQ/Interview/#)
  - [ã€Œ6.4 å­˜å‚¨ç›®å½•ç»“æ„ã€](http://svip.iocoder.cn/RocketMQ/Interview/#)
  - [ã€Œ7.1 å•æœºæ”¯æŒ 1 ä¸‡ä»¥ä¸ŠæŒä¹…åŒ–é˜Ÿåˆ—ã€](http://svip.iocoder.cn/RocketMQ/Interview/#)
  - [ã€Œ7.2 åˆ·ç›˜ç­–ç•¥ã€](http://svip.iocoder.cn/RocketMQ/Interview/#)

- ç™«ç‹‚ä¾ 

  - [ã€Šæ¶ˆæ¯ä¸­é—´ä»¶ â€”â€” RocketMQæ¶ˆæ¯å­˜å‚¨ï¼ˆä¸€ï¼‰ã€‹](https://www.jianshu.com/p/b73fdd893f98)
  - [ã€Šæ¶ˆæ¯ä¸­é—´ä»¶ â€”â€” RocketMQæ¶ˆæ¯å­˜å‚¨ï¼ˆäºŒï¼‰ã€‹](https://www.jianshu.com/p/6d0c118c17de)

## è¯·è¯´è¯´ä½ å¯¹ Producer çš„äº†è§£ï¼Ÿ

- 1ã€**è·å¾— Topic-Broker çš„æ˜ å°„å…³ç³»**ã€‚

  - Producer å¯åŠ¨æ—¶ï¼Œä¹Ÿéœ€è¦æŒ‡å®š Namesrv çš„åœ°å€ï¼Œä» Namesrv é›†ç¾¤ä¸­é€‰ä¸€å°å»ºç«‹é•¿è¿æ¥ã€‚å¦‚æœè¯¥ Namesrv å®•æœºï¼Œä¼šè‡ªåŠ¨è¿å…¶ä»– Namesrv ï¼Œç›´åˆ°æœ‰å¯ç”¨çš„ Namesrv ä¸ºæ­¢ã€‚
  - ç”Ÿäº§è€…æ¯ 30 ç§’ä» Namesrv è·å– Topic è·Ÿ Broker çš„æ˜ å°„å…³ç³»ï¼Œæ›´æ–°åˆ°æœ¬åœ°å†…å­˜ä¸­ã€‚ç„¶åå†è·Ÿ Topic æ¶‰åŠçš„æ‰€æœ‰ Broker å»ºç«‹é•¿è¿æ¥ï¼Œæ¯éš” 30 ç§’å‘ä¸€æ¬¡å¿ƒè·³ã€‚
  - åœ¨ Broker ç«¯ä¹Ÿä¼šæ¯ 10 ç§’æ‰«æä¸€æ¬¡å½“å‰æ³¨å†Œçš„ Producer ï¼Œå¦‚æœå‘ç°æŸä¸ª Producer è¶…è¿‡ 2 åˆ†é’Ÿéƒ½æ²¡æœ‰å‘å¿ƒè·³ï¼Œåˆ™æ–­å¼€è¿æ¥ã€‚

- 2ã€**ç”Ÿäº§è€…ç«¯çš„è´Ÿè½½å‡è¡¡**ã€‚

  - ç”Ÿäº§è€…å‘é€æ—¶ï¼Œä¼šè‡ªåŠ¨è½®è¯¢å½“å‰æ‰€æœ‰å¯å‘é€çš„brokerï¼Œä¸€æ¡æ¶ˆæ¯å‘é€æˆåŠŸï¼Œä¸‹æ¬¡æ¢å¦å¤–ä¸€ä¸ªbrokerå‘é€ï¼Œä»¥è¾¾åˆ°æ¶ˆæ¯å¹³å‡è½åˆ°æ‰€æœ‰çš„brokerä¸Šã€‚

    > è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ç‚¹ï¼šå‡å¦‚æŸä¸ª Broker å®•æœºï¼Œæ„å‘³ç”Ÿäº§è€…æœ€é•¿éœ€è¦ 30 ç§’æ‰èƒ½æ„ŸçŸ¥åˆ°ã€‚åœ¨è¿™æœŸé—´ä¼šå‘å®•æœºçš„ Broker å‘é€æ¶ˆæ¯ã€‚å½“ä¸€æ¡æ¶ˆæ¯å‘é€åˆ°æŸä¸ª Broker å¤±è´¥åï¼Œä¼šè‡ªåŠ¨å†é‡å‘ 2 æ¬¡ï¼Œå‡å¦‚è¿˜æ˜¯å‘é€å¤±è´¥ï¼Œåˆ™æŠ›å‡ºå‘é€å¤±è´¥å¼‚å¸¸ã€‚
    >
    > å®¢æˆ·ç«¯é‡Œä¼šè‡ªåŠ¨è½®è¯¢å¦å¤–ä¸€ä¸ª Broker é‡æ–°å‘é€ï¼Œè¿™ä¸ªå¯¹äºç”¨æˆ·æ˜¯é€æ˜çš„ã€‚

## Producer å‘é€æ¶ˆæ¯æœ‰å‡ ç§æ–¹å¼ï¼Ÿ

Producer å‘é€æ¶ˆæ¯ï¼Œæœ‰ä¸‰ç§æ–¹å¼ï¼š

1. åŒæ­¥æ–¹å¼
2. å¼‚æ­¥æ–¹å¼
3. Oneway æ–¹å¼

å…¶ä¸­ï¼Œæ–¹å¼ 1 å’Œ 2 æ¯”è¾ƒå¸¸è§ï¼Œå…·ä½“ä½¿ç”¨å“ªä¸€ç§æ–¹å¼éœ€è¦æ ¹æ®ä¸šåŠ¡æƒ…å†µæ¥åˆ¤æ–­ã€‚è€Œæ–¹å¼ 3 ï¼Œé€‚åˆå¤§æ•°æ®åœºæ™¯ï¼Œå…è®¸æœ‰ä¸€å®šæ¶ˆæ¯ä¸¢å¤±çš„åœºæ™¯ã€‚

## è¯·è¯´è¯´ä½ å¯¹ Consumer çš„äº†è§£ï¼Ÿ

- 1ã€

  è·å¾— Topic-Broker çš„æ˜ å°„å…³ç³»

  ã€‚

  - Consumer å¯åŠ¨æ—¶éœ€è¦æŒ‡å®š Namesrv åœ°å€ï¼Œä¸å…¶ä¸­ä¸€ä¸ª Namesrv å»ºç«‹é•¿è¿æ¥ã€‚æ¶ˆè´¹è€…æ¯éš” 30 ç§’ä» Namesrv è·å–æ‰€æœ‰Topic çš„æœ€æ–°é˜Ÿåˆ—æƒ…å†µï¼Œè¿™æ„å‘³ç€æŸä¸ª Broker å¦‚æœå®•æœºï¼Œå®¢æˆ·ç«¯æœ€å¤šè¦ 30 ç§’æ‰èƒ½æ„ŸçŸ¥ã€‚è¿æ¥å»ºç«‹åï¼Œä» Namesrv ä¸­è·å–å½“å‰æ¶ˆè´¹ Topic æ‰€æ¶‰åŠçš„ Brokerï¼Œç›´è¿ Broker ã€‚
  - Consumer è·Ÿ Broker æ˜¯é•¿è¿æ¥ï¼Œä¼šæ¯éš” 30 ç§’å‘å¿ƒè·³ä¿¡æ¯åˆ°Broker ã€‚Broker ç«¯æ¯ 10 ç§’æ£€æŸ¥ä¸€æ¬¡å½“å‰å­˜æ´»çš„ Consumer ï¼Œè‹¥å‘ç°æŸä¸ª Consumer 2 åˆ†é’Ÿå†…æ²¡æœ‰å¿ƒè·³ï¼Œå°±æ–­å¼€ä¸è¯¥ Consumer çš„è¿æ¥ï¼Œå¹¶ä¸”å‘è¯¥æ¶ˆè´¹ç»„çš„å…¶ä»–å®ä¾‹å‘é€é€šçŸ¥ï¼Œè§¦å‘è¯¥æ¶ˆè´¹è€…é›†ç¾¤çš„è´Ÿè½½å‡è¡¡ã€‚

- 2ã€**æ¶ˆè´¹è€…ç«¯çš„è´Ÿè½½å‡è¡¡**ã€‚æ ¹æ®æ¶ˆè´¹è€…çš„æ¶ˆè´¹æ¨¡å¼ä¸åŒï¼Œè´Ÿè½½å‡è¡¡æ–¹å¼ä¹Ÿä¸åŒã€‚

  > æ¶ˆè´¹è€…æœ‰ä¸¤ç§æ¶ˆè´¹æ¨¡å¼ï¼šé›†ç¾¤æ¶ˆè´¹å’Œå¹¿æ’­æ¶ˆè´¹ã€‚
  >
  > - é›†ç¾¤æ¶ˆè´¹ï¼šä¸€ä¸ª Topic å¯ä»¥ç”±åŒä¸€ä¸ªæ¶ˆè´¹è¿™åˆ†ç»„( Consumer Group )ä¸‹æ‰€æœ‰æ¶ˆè´¹è€…åˆ†æ‹…æ¶ˆè´¹ã€‚
  >   å…·ä½“ä¾‹å­ï¼šå‡å¦‚ TopicA æœ‰ 6 ä¸ªé˜Ÿåˆ—ï¼ŒæŸä¸ªæ¶ˆè´¹è€…åˆ†ç»„èµ·äº† 2 ä¸ªæ¶ˆè´¹è€…å®ä¾‹ï¼Œé‚£ä¹ˆæ¯ä¸ªæ¶ˆè´¹è€…è´Ÿè´£æ¶ˆè´¹ 3 ä¸ªé˜Ÿåˆ—ã€‚å¦‚æœå†å¢åŠ ä¸€ä¸ªæ¶ˆè´¹è€…åˆ†ç»„ç›¸åŒæ¶ˆè´¹è€…å®ä¾‹ï¼Œå³å½“å‰å…±æœ‰ 3 ä¸ªæ¶ˆè´¹è€…åŒæ—¶æ¶ˆè´¹ 6 ä¸ªé˜Ÿåˆ—ï¼Œé‚£æ¯ä¸ªæ¶ˆè´¹è€…è´Ÿè´£ 2 ä¸ªé˜Ÿåˆ—çš„æ¶ˆè´¹ã€‚

  - å¹¿æ’­æ¶ˆè´¹ï¼šæ¯ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ Topic ä¸‹çš„æ‰€æœ‰é˜Ÿåˆ—ã€‚

## æ¶ˆè´¹è€…æ¶ˆè´¹æ¨¡å¼æœ‰å‡ ç§ï¼Ÿ

æ¶ˆè´¹è€…æ¶ˆè´¹æ¨¡å¼æœ‰ä¸¤ç§ï¼šé›†ç¾¤æ¶ˆè´¹å’Œå¹¿æ’­æ¶ˆè´¹ã€‚

ğŸ¦… **1. é›†ç¾¤æ¶ˆè´¹**

æ¶ˆè´¹è€…çš„ä¸€ç§æ¶ˆè´¹æ¨¡å¼ã€‚ä¸€ä¸ª Consumer Group ä¸­çš„å„ä¸ª Consumer å®ä¾‹åˆ†æ‘Šå»æ¶ˆè´¹æ¶ˆæ¯ï¼Œå³ä¸€æ¡æ¶ˆæ¯åªä¼šæŠ•é€’åˆ°ä¸€ä¸ª Consumer Group ä¸‹é¢çš„ä¸€ä¸ªå®ä¾‹ã€‚

- å®é™…ä¸Šï¼Œæ¯ä¸ª Consumer æ˜¯å¹³å‡åˆ†æ‘Š Message Queue çš„å»åšæ‹‰å–æ¶ˆè´¹ã€‚ä¾‹å¦‚æŸä¸ª Topic æœ‰ 3 ä¸ªé˜Ÿåˆ—ï¼Œå…¶ä¸­ä¸€ä¸ª Consumer Group æœ‰ 3 ä¸ªå®ä¾‹ï¼ˆå¯èƒ½æ˜¯ 3 ä¸ªè¿›ç¨‹ï¼Œæˆ–è€… 3 å°æœºå™¨ï¼‰ï¼Œé‚£ä¹ˆæ¯ä¸ªå®ä¾‹åªæ¶ˆè´¹å…¶ä¸­çš„ 1 ä¸ªé˜Ÿåˆ—ã€‚
- è€Œç”± Producer å‘é€æ¶ˆæ¯çš„æ—¶å€™æ˜¯è½®è¯¢æ‰€æœ‰çš„é˜Ÿåˆ—ï¼Œæ‰€ä»¥æ¶ˆæ¯ä¼šå¹³å‡æ•£è½åœ¨ä¸åŒçš„é˜Ÿåˆ—ä¸Šï¼Œå¯ä»¥è®¤ä¸ºé˜Ÿåˆ—ä¸Šçš„æ¶ˆæ¯æ˜¯å¹³å‡çš„ã€‚é‚£ä¹ˆå®ä¾‹ä¹Ÿå°±å¹³å‡åœ°æ¶ˆè´¹æ¶ˆæ¯äº†ã€‚
- è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ¶ˆè´¹è¿›åº¦çš„å­˜å‚¨ä¼šæŒä¹…åŒ–åˆ° Broker ã€‚
- å½“æ–°å»ºä¸€ä¸ª Consumer Group æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥åˆ†ç»„çš„æ¶ˆè´¹è€…ä¼šä» min offset å¼€å§‹é‡æ–°æ¶ˆè´¹æ¶ˆæ¯ã€‚

ğŸ¦… **2. å¹¿æ’­æ¶ˆè´¹**

æ¶ˆè´¹è€…çš„ä¸€ç§æ¶ˆè´¹æ¨¡å¼ã€‚æ¶ˆæ¯å°†å¯¹ä¸€ ä¸ªConsumer Group ä¸‹çš„å„ä¸ª Consumer å®ä¾‹éƒ½æŠ•é€’ä¸€éã€‚å³å³ä½¿è¿™äº› Consumer å±äºåŒä¸€ä¸ªConsumer Group ï¼Œæ¶ˆæ¯ä¹Ÿä¼šè¢« Consumer Group ä¸­çš„æ¯ä¸ª Consumer éƒ½æ¶ˆè´¹ä¸€æ¬¡ã€‚

- å®é™…ä¸Šï¼Œæ˜¯ä¸€ä¸ªæ¶ˆè´¹ç»„ä¸‹çš„æ¯ä¸ªæ¶ˆè´¹è€…å®ä¾‹éƒ½è·å–åˆ°äº† Topic ä¸‹é¢çš„æ¯ä¸ª Message Queue å»æ‹‰å–æ¶ˆè´¹ã€‚æ‰€ä»¥æ¶ˆæ¯ä¼šæŠ•é€’åˆ°æ¯ä¸ªæ¶ˆè´¹è€…å®ä¾‹ã€‚
- è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ¶ˆè´¹è¿›åº¦ä¼šå­˜å‚¨æŒä¹…åŒ–åˆ°å®ä¾‹æœ¬åœ°ã€‚

## æ¶ˆè´¹è€…è·å–æ¶ˆæ¯æœ‰å‡ ç§æ¨¡å¼ï¼Ÿ

æ¶ˆè´¹è€…è·å–æ¶ˆæ¯æœ‰ä¸¤ç§æ¨¡å¼ï¼šæ¨é€æ¨¡å¼å’Œæ‹‰å–æ¨¡å¼ã€‚

ğŸ¦… **1. PushConsumer**

æ¨é€æ¨¡å¼ï¼ˆè™½ç„¶ RocketMQ ä½¿ç”¨çš„æ˜¯é•¿è½®è¯¢ï¼‰çš„æ¶ˆè´¹è€…ã€‚æ¶ˆæ¯çš„èƒ½åŠæ—¶è¢«æ¶ˆè´¹ã€‚ä½¿ç”¨éå¸¸ç®€å•ï¼Œå†…éƒ¨å·²å¤„ç†å¦‚çº¿ç¨‹æ± æ¶ˆè´¹ã€æµæ§ã€è´Ÿè½½å‡è¡¡ã€å¼‚å¸¸å¤„ç†ç­‰ç­‰çš„å„ç§åœºæ™¯ã€‚

- é•¿è½®è¯¢ï¼Œå°±æ˜¯æˆ‘ä»¬åœ¨ [ã€Š ç²¾å°½ã€æ¶ˆæ¯é˜Ÿåˆ— ã€‘é¢è¯•é¢˜ã€‹](http://svip.iocoder.cn/MQ/Interview) æåˆ°çš„ï¼Œpush + pull æ¨¡å¼ç»“åˆçš„æ–¹å¼ã€‚

ğŸ¦… **2. PullConsumer**

æ‹‰å–æ¨¡å¼çš„æ¶ˆè´¹è€…ã€‚åº”ç”¨ä¸»åŠ¨æ§åˆ¶æ‹‰å–çš„æ—¶æœºï¼Œæ€ä¹ˆæ‹‰å–ï¼Œæ€ä¹ˆæ¶ˆè´¹ç­‰ã€‚ä¸»åŠ¨æƒæ›´é«˜ã€‚ä½†è¦è‡ªå·±å¤„ç†å„ç§åœºæ™¯ã€‚

------

å†³ç»ç»å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬åªä¼šä½¿ç”¨ PushConsumer æ¨é€æ¨¡å¼ã€‚ğŸ˜ˆ è‡³å°‘è‰¿è‰¿ç›®å‰ï¼Œæš‚æ—¶è¿˜æ²¡ç”¨è¿‡ PullConsumer ã€‚

## å¦‚ä½•å¯¹æ¶ˆæ¯è¿›è¡Œé‡æ”¾ï¼Ÿ

æ¶ˆè´¹ä½ç‚¹å°±æ˜¯ä¸€ä¸ªæ•°å­—ï¼ŒæŠŠ Consumer Offset æ”¹ä¸€ä¸‹ï¼Œå°±å¯ä»¥è¾¾åˆ°é‡æ”¾çš„ç›®çš„äº†ã€‚

## ä»€ä¹ˆæ˜¯é¡ºåºæ¶ˆæ¯ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿ

æ¶ˆè´¹æ¶ˆæ¯çš„é¡ºåºè¦åŒå‘é€æ¶ˆæ¯çš„é¡ºåºä¸€è‡´ã€‚ç”±äº Consumer æ¶ˆè´¹æ¶ˆæ¯çš„æ—¶å€™æ˜¯é’ˆå¯¹ Message Queue é¡ºåºæ‹‰å–å¹¶å¼€å§‹æ¶ˆè´¹ï¼Œä¸”ä¸€æ¡ Message Queue åªä¼šç»™ä¸€ä¸ªæ¶ˆè´¹è€…ï¼ˆé›†ç¾¤æ¨¡å¼ä¸‹ï¼‰ï¼Œæ‰€ä»¥èƒ½å¤Ÿä¿è¯åŒä¸€ä¸ªæ¶ˆè´¹è€…å®ä¾‹å¯¹äº Queue ä¸Šæ¶ˆæ¯çš„æ¶ˆè´¹æ˜¯é¡ºåºåœ°å¼€å§‹æ¶ˆè´¹ï¼ˆä¸ä¸€å®šé¡ºåºæ¶ˆè´¹å®Œæˆï¼Œå› ä¸ºæ¶ˆè´¹å¯èƒ½å¹¶è¡Œï¼‰ã€‚

- Consumer ï¼šåœ¨ RocketMQ ä¸­ï¼Œé¡ºåºæ¶ˆè´¹ä¸»è¦æŒ‡çš„æ˜¯éƒ½æ˜¯ Queue çº§åˆ«çš„å±€éƒ¨é¡ºåºã€‚è¿™ä¸€ç±»æ¶ˆæ¯ä¸ºæ»¡è¶³é¡ºåºæ€§ï¼Œå¿…é¡» Producer å•çº¿ç¨‹é¡ºåºå‘é€ï¼Œä¸”å‘é€åˆ°åŒä¸€ä¸ªé˜Ÿåˆ—ï¼Œè¿™æ · Consumer å°±å¯ä»¥æŒ‰ç…§ Producer å‘é€çš„é¡ºåºå»æ¶ˆè´¹æ¶ˆæ¯ã€‚
- Producer ï¼šç”Ÿäº§è€…å‘é€çš„æ—¶å€™å¯ä»¥ç”¨ MessageQueueSelector ä¸ºæŸä¸€æ‰¹æ¶ˆæ¯ï¼ˆé€šå¸¸æ˜¯æœ‰ç›¸åŒçš„å”¯ä¸€æ ‡ç¤ºidï¼‰é€‰æ‹©åŒä¸€ä¸ª Queue ï¼Œåˆ™è¿™ä¸€æ‰¹æ¶ˆæ¯çš„æ¶ˆè´¹å°†æ˜¯é¡ºåºæ¶ˆæ¯ï¼ˆå¹¶ç”±åŒä¸€ä¸ªconsumerå®Œæˆæ¶ˆæ¯ï¼‰ã€‚æˆ–è€… Message Queue çš„æ•°é‡åªæœ‰ 1 ï¼Œä½†è¿™æ ·æ¶ˆè´¹çš„å®ä¾‹åªèƒ½æœ‰ä¸€ä¸ªï¼Œå¤šå‡ºæ¥çš„å®ä¾‹éƒ½ä¼šç©ºè·‘ã€‚

**å½“ç„¶ï¼Œä¸Šé¢çš„æ–‡å­—æ¯”è¾ƒç»•ï¼Œæ€»çš„æ¥è¯´ï¼ŒRocketMQ æä¾›äº†ä¸¤ç§é¡ºåºçº§åˆ«**ï¼š

- æ™®é€šé¡ºåºæ¶ˆæ¯ ï¼šProducer å°†ç›¸å…³è”çš„æ¶ˆæ¯å‘é€åˆ°ç›¸åŒçš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚

- ä¸¥æ ¼é¡ºåºæ¶ˆæ¯ ï¼šåœ¨ã€æ™®é€šé¡ºåºæ¶ˆæ¯ã€‘çš„åŸºç¡€ä¸Šï¼ŒConsumer ä¸¥æ ¼é¡ºåºæ¶ˆè´¹ã€‚

  > ä¹Ÿå°±è¯´ï¼Œé¡ºåºæ¶ˆæ¯åŒ…æ‹¬ä¸¤å—ï¼šProducer çš„é¡ºåºå‘é€ï¼Œå’Œ Consumer çš„é¡ºåºæ¶ˆè´¹ã€‚

ğŸ¦… **1. æ™®é€šé¡ºåºæ¶ˆæ¯**

é¡ºåºæ¶ˆæ¯çš„ä¸€ç§ï¼Œæ­£å¸¸æƒ…å†µä¸‹å¯ä»¥ä¿è¯å®Œå…¨çš„é¡ºåºæ¶ˆæ¯ï¼Œä½†æ˜¯ä¸€æ—¦å‘ç”Ÿå¼‚å¸¸ï¼ŒBroker å®•æœºæˆ–é‡å¯ï¼Œç”±äºé˜Ÿåˆ—æ€»æ•°å‘ç”Ÿå‘åŒ–ï¼Œæ¶ˆè´¹è€…ä¼šè§¦å‘è´Ÿè½½å‡è¡¡ï¼Œè€Œé»˜è®¤åœ°è´Ÿè½½å‡è¡¡ç®—æ³•é‡‡å–å“ˆå¸Œå–æ¨¡å¹³å‡ï¼Œè¿™æ ·è´Ÿè½½å‡è¡¡åˆ†é…åˆ°å®šä½çš„é˜Ÿåˆ—ä¼šå‘åŒ–ï¼Œä½¿å¾—é˜Ÿåˆ—å¯èƒ½åˆ†é…åˆ°åˆ«çš„å®ä¾‹ä¸Šï¼Œåˆ™ä¼šçŸ­æš‚åœ°å‡ºç°æ¶ˆæ¯é¡ºåºä¸ä¸€è‡´ã€‚

å¦‚æœä¸šåŠ¡èƒ½å®¹å¿åœ¨é›†ç¾¤å¼‚å¸¸æƒ…å†µï¼ˆå¦‚æŸä¸ª Broker å®•æœºæˆ–è€…é‡å¯ï¼‰ä¸‹ï¼Œæ¶ˆæ¯çŸ­æš‚çš„ä¹±åºï¼Œä½¿ç”¨æ™®é€šé¡ºåºæ–¹å¼æ¯”è¾ƒåˆé€‚ã€‚

ğŸ¦… **2. ä¸¥æ ¼é¡ºåºæ¶ˆæ¯**

é¡ºåºæ¶ˆæ¯çš„ä¸€ç§ï¼Œæ— è®ºæ­£å¸¸å¼‚å¸¸æƒ…å†µéƒ½èƒ½ä¿è¯é¡ºåºï¼Œä½†æ˜¯ç‰ºç‰²äº†åˆ†å¸ƒå¼ Failover ç‰¹æ€§ï¼Œå³ Broker é›†ç¾¤ä¸­åªè¦æœ‰ä¸€å°æœºå™¨ä¸å¯ç”¨ï¼Œåˆ™æ•´ä¸ªé›†ç¾¤éƒ½ä¸å¯ç”¨ï¼ŒæœåŠ¡å¯ç”¨æ€§å¤§å¤§é™ä½ã€‚

å¦‚æœæœåŠ¡å™¨éƒ¨ç½²ä¸ºåŒæ­¥åŒå†™æ¨¡å¼ï¼Œæ­¤ç¼ºé™·å¯é€šè¿‡å¤‡æœºè‡ªåŠ¨åˆ‡æ¢ä¸ºä¸»é¿å…ï¼Œä¸è¿‡ä»ç„¶ä¼šå­˜åœ¨å‡ åˆ†é’Ÿçš„æœåŠ¡ä¸å¯ç”¨ã€‚ï¼ˆä¾èµ–åŒæ­¥åŒå†™ï¼Œä¸»å¤‡è‡ªåŠ¨åˆ‡æ¢ï¼Œè‡ªåŠ¨åˆ‡æ¢åŠŸèƒ½ç›®å‰å¹¶æœªå®ç°ï¼‰

ğŸ¦… **å°ç»“**

ç›®å‰å·²çŸ¥çš„åº”ç”¨åªæœ‰æ•°æ®åº“ binlog åŒæ­¥å¼ºä¾èµ–ä¸¥æ ¼é¡ºåºæ¶ˆæ¯ï¼Œå…¶ä»–åº”ç”¨ç»å¤§éƒ¨åˆ†éƒ½å¯ä»¥å®¹å¿çŸ­æš‚ä¹±åºï¼Œæ¨èä½¿ç”¨æ™®é€šçš„é¡ºåºæ¶ˆæ¯ã€‚

ğŸ¦… **å®ç°åŸç†**

é¡ºåºæ¶ˆæ¯çš„å®ç°ï¼Œç›¸å¯¹æ¯”è¾ƒå¤æ‚ï¼Œæƒ³è¦æ·±å…¥ç†è§£çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹ [ã€ŠRocketMQ æºç åˆ†æ â€”â€” Message é¡ºåºå‘é€ä¸æ¶ˆè´¹ã€‹](http://www.iocoder.cn/RocketMQ/message-send-and-consume-orderly/) ã€‚

## é¡ºåºæ¶ˆæ¯æ‰©å®¹çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•åœ¨ä¸åœå†™çš„æƒ…å†µä¸‹ä¿è¯æ¶ˆæ¯é¡ºåºï¼Ÿ

1. æˆå€æ‰©å®¹ï¼Œå®ç°æ‰©å®¹å‰åï¼ŒåŒæ ·çš„ keyï¼Œhash åˆ°åŸé˜Ÿåˆ—ï¼Œæˆ–è€… hash åˆ°æ–°æ‰©å®¹çš„é˜Ÿåˆ—ã€‚
2. æ‰©å®¹å‰ï¼Œè®°å½•æ—§é˜Ÿåˆ—ä¸­çš„æœ€å¤§ä½ç‚¹ã€‚
3. å¯¹äºæ¯ä¸ª Consumer Group ï¼Œä¿è¯æ—§é˜Ÿåˆ—ä¸­çš„æ•°æ®æ¶ˆè´¹å®Œï¼Œå†æ¶ˆè´¹æ–°é˜Ÿåˆ—ï¼Œä¹Ÿå³ï¼šå…ˆå¯¹æ–°é˜Ÿåˆ—è¿›è¡Œç¦è¯»å³å¯ã€‚

## ä»€ä¹ˆæ˜¯å®šæ—¶æ¶ˆæ¯ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿ

å®šæ—¶æ¶ˆæ¯ï¼Œæ˜¯æŒ‡æ¶ˆæ¯å‘åˆ° Broker åï¼Œä¸èƒ½ç«‹åˆ»è¢« Consumer æ¶ˆè´¹ï¼Œè¦åˆ°ç‰¹å®šçš„æ—¶é—´ç‚¹æˆ–è€…ç­‰å¾…ç‰¹å®šçš„æ—¶é—´åæ‰èƒ½è¢«æ¶ˆè´¹ã€‚

ç›®å‰ï¼Œå¼€æºç‰ˆæœ¬çš„ RocketMQ åªæ”¯æŒå›ºå®šå»¶è¿Ÿçº§åˆ«çš„å»¶è¿Ÿæ¶ˆæ¯ï¼Œä¸æ”¯æŒä»»ä¸€æ—¶åˆ»çš„å»¶è¿Ÿæ¶ˆæ¯ã€‚å¦‚ä¸‹è¡¨æ ¼ï¼š

| å»¶è¿Ÿçº§åˆ« | æ—¶é—´ |
| -------- | ---- |
| 1        | 1s   |
| 2        | 5s   |
| 3        | 10s  |
| 4        | 30s  |
| 5        | 1m   |
| 6        | 2m   |
| 7        | 3m   |
| 8        | 4m   |
| 9        | 5m   |
| 10       | 6m   |
| 11       | 7m   |
| 12       | 8m   |
| 13       | 9m   |
| 14       | 10m  |
| 15       | 20m  |
| 16       | 30m  |
| 17       | 1h   |
| 18       | 2h   |

- å¯é€šè¿‡é…ç½®æ–‡ä»¶ï¼Œè‡ªå®šä¹‰æ¯ä¸ªå»¶è¿Ÿçº§åˆ«å¯¹åº”çš„å»¶è¿Ÿæ—¶é—´ã€‚å½“ç„¶ï¼Œè¿™æ˜¯å…¨å±€çš„ã€‚
- å¦‚æœèƒ–å‹æƒ³è¦å®ç°ä»»ä¸€æ—¶åˆ»çš„å»¶è¿Ÿæ¶ˆæ¯ï¼Œæ¯”è¾ƒç®€å•çš„æ–¹å¼æ˜¯æ’å…¥å»¶è¿Ÿæ¶ˆæ¯åˆ°æ•°æ®åº“ä¸­ï¼Œç„¶åé€šè¿‡å®šæ—¶ä»»åŠ¡è½®è¯¢ï¼Œåˆ°è¾¾æŒ‡å®šæ—¶é—´ï¼Œå‘é€åˆ° RocketMQ ä¸­ã€‚

ğŸ¦… **å®ç°åŸç†**

- 1ã€ å®šæ—¶æ¶ˆæ¯å‘é€åˆ° Broker åï¼Œä¼šè¢«å­˜å‚¨ Topic ä¸º `SCHEDULE_TOPIC_XXXX` ä¸­ï¼Œå¹¶ä¸”æ‰€åœ¨ Queue ç¼–å·ä¸ºå»¶è¿Ÿçº§åˆ« - 1 ã€‚

  > éœ€è¦ -1 çš„åŸå› æ˜¯ï¼Œå»¶è¿Ÿçº§åˆ«æ˜¯ä» 1 å¼€å§‹çš„ã€‚å¦‚æœå»¶è¿Ÿçº§åˆ«ä¸º 0 ï¼Œæ„å‘³ç€æ— éœ€å»¶è¿Ÿã€‚

- 2ã€Broker é’ˆå¯¹æ¯ä¸ª `SCHEDULE_TOPIC_XXXX` çš„é˜Ÿåˆ—ï¼Œéƒ½åˆ›å»ºä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œ**é¡ºåº**æ‰«æåˆ°è¾¾æ—¶é—´çš„å»¶è¿Ÿæ¶ˆæ¯ï¼Œé‡æ–°å­˜å‚¨åˆ°å»¶è¿Ÿæ¶ˆæ¯**åŸå§‹**çš„ Topic çš„**åŸå§‹** Queue ä¸­ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥è¢« Consumer æ¶ˆè´¹åˆ°ã€‚æ­¤å¤„ä¼šæœ‰ä¸¤ä¸ªé—®é¢˜ï¼š

  - ä¸ºä»€ä¹ˆæ˜¯â€œ**é¡ºåº**æ‰«æåˆ°è¾¾æ—¶é—´çš„å»¶è¿Ÿæ¶ˆæ¯â€ï¼Ÿå› ä¸ºå…ˆè¿› `SCHEDULE_TOPIC_XXXX` çš„å»¶è¿Ÿæ¶ˆæ¯ï¼Œåœ¨å…¶æ‰€åœ¨çš„é˜Ÿåˆ—ï¼Œæ„å‘³ç€å…ˆåˆ°è¾¾å»¶è¿Ÿæ—¶é—´ã€‚
  - ä¼šä¸ä¼šå­˜åœ¨é‡å¤æ‰«æçš„æƒ…å†µï¼Ÿæ¯ä¸ª `SCHEDULE_TOPIC_XXXX` çš„æ‰«æè¿›åº¦ï¼Œä¼šæ¯ 10s å­˜å‚¨åˆ° `config/delayOffset.json` æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸ä¼šå­˜åœ¨é‡å¤æ‰«æã€‚å¦‚æœå¼‚å¸¸å…³é—­ï¼Œåˆ™å¯èƒ½å¯¼è‡´é‡å¤æ‰«æã€‚

è¯¦ç»†çš„ï¼Œèƒ–å‹å¯ä»¥çœ‹çœ‹ [ã€ŠRocketMQ æºç åˆ†æ â€”â€” å®šæ—¶æ¶ˆæ¯ä¸æ¶ˆæ¯é‡è¯•ã€‹](http://www.iocoder.cn/RocketMQ/message-schedule-and-retry/) ã€‚

## ä»€ä¹ˆæ˜¯æ¶ˆæ¯é‡è¯•ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿ

æ¶ˆæ¯é‡è¯•ï¼ŒConsumer æ¶ˆè´¹æ¶ˆæ¯å¤±è´¥åï¼Œè¦æä¾›ä¸€ç§é‡è¯•æœºåˆ¶ï¼Œä»¤æ¶ˆæ¯å†æ¶ˆè´¹ä¸€æ¬¡ã€‚

- Consumer ä¼šå°†æ¶ˆè´¹å¤±è´¥çš„æ¶ˆæ¯å‘å› Brokerï¼Œè¿›å…¥å»¶è¿Ÿæ¶ˆæ¯é˜Ÿåˆ—ã€‚å³ï¼Œæ¶ˆè´¹å¤±è´¥çš„æ¶ˆæ¯ï¼Œä¸ä¼šç«‹å³æ¶ˆè´¹ã€‚
- ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¶ˆæ¯é‡è¯•æ˜¯æ„å»ºåœ¨å®šæ—¶æ¶ˆæ¯ä¹‹ä¸Šçš„åŠŸèƒ½ã€‚

ğŸ¦… **æ¶ˆæ¯é‡è¯•çš„ä¸»è¦æµç¨‹**

1. Consumer æ¶ˆè´¹å¤±è´¥ï¼Œå°†æ¶ˆæ¯å‘é€å› Broker ã€‚
2. Broker æ”¶åˆ°é‡è¯•æ¶ˆæ¯ä¹‹åç½®æ¢ Topic ï¼Œå­˜å‚¨æ¶ˆæ¯ã€‚
3. Consumer ä¼šæ‹‰å–è¯¥ Topic å¯¹åº”çš„ retryTopic çš„æ¶ˆæ¯ã€‚
4. Consumer æ‹‰å–åˆ° retryTopic æ¶ˆæ¯ä¹‹åï¼Œç½®æ¢åˆ°åŸå§‹çš„ Topic ï¼ŒæŠŠæ¶ˆæ¯äº¤ç»™ Listener æ¶ˆè´¹ã€‚

è¿™é‡Œï¼Œå¯èƒ½æœ‰å‡ ä¸ªç‚¹ï¼Œèƒ–å‹ä¼šæ¯”è¾ƒæ‡µé€¼ï¼Œè‰¿è‰¿ç®€å•è§£é‡Šä¸‹ï¼š

1. Consumer æ¶ˆæ¯å¤±è´¥åï¼Œä¼šå°†æ¶ˆæ¯çš„ Topic ä¿®æ”¹ä¸º `%RETRY%` + Topic è¿›è¡Œï¼Œæ·»åŠ  `"RETRY_TOPIC"` å±æ€§ä¸ºåŸå§‹ Topic ï¼Œç„¶åå†è¿”å›ç»™ Broker ä¸­ã€‚
2. Broker æ”¶åˆ°é‡è¯•æ¶ˆæ¯ä¹‹åï¼Œä¼šæœ‰ä¸¤æ¬¡ä¿®æ”¹æ¶ˆæ¯çš„ Topic ã€‚
   - é¦–å…ˆï¼Œä¼šå°†æ¶ˆæ¯çš„ Topic ä¿®æ”¹ä¸º `%RETRY%` + ConsumerGroup ï¼Œå› ä¸ºè¿™ä¸ªæ¶ˆæ¯æ˜¯å½“å‰æ¶ˆè´¹è¿™åˆ†ç»„æ¶ˆè´¹å¤±è´¥ï¼Œåªèƒ½è¢«è¿™ä¸ªæ¶ˆè´¹ç»„æ‰€é‡æ–°æ¶ˆè´¹ã€‚ğŸ˜ˆ æ³¨æ„å™¢ï¼Œæ¶ˆè´¹è€…ä¼šé»˜è®¤è®¢é˜… Topic ä¸º `%RETRY%` + ConsumerGroup çš„æ¶ˆæ¯ã€‚
   - ç„¶åï¼Œä¼šå°†æ¶ˆæ¯çš„ Topic ä¿®æ”¹ä¸º `SCHEDULE_TOPIC_XXXX` ï¼Œæ·»åŠ  `"REAL_TOPIC"` å±æ€§ä¸º `%RETRY%` + ConsumerGroup ï¼Œå› ä¸ºé‡è¯•æ¶ˆæ¯éœ€è¦å»¶è¿Ÿæ¶ˆè´¹ã€‚
3. Consumer ä¼šæ‹‰å–è¯¥ Topic å¯¹åº”çš„ retryTopic çš„æ¶ˆæ¯ï¼Œæ­¤å¤„çš„ retryTopic ä¸º `%RETRY%` + ConsumerGroup ã€‚
4. Consumer æ‹‰å–åˆ° retryTopic æ¶ˆæ¯ä¹‹åï¼Œç½®æ¢åˆ°åŸå§‹çš„ Topic ï¼Œå› ä¸ºæœ‰æ¶ˆæ¯çš„ `"RETRY_TOPIC"` å±æ€§æ˜¯åŸå§‹ Topic ï¼Œç„¶åæŠŠæ¶ˆæ¯äº¤ç»™ Listener æ¶ˆè´¹ã€‚

ğŸ˜ˆ æœ‰ä¸€ä¸¢ä¸¢å¤æ‚ï¼Œèƒ–å‹å¯ä»¥åœ¨æ€è€ƒæ€è€ƒ~è¯¦ç»†çš„ï¼Œèƒ–å‹å¯ä»¥çœ‹çœ‹ [ã€ŠRocketMQ æºç åˆ†æ â€”â€” å®šæ—¶æ¶ˆæ¯ä¸æ¶ˆæ¯é‡è¯•ã€‹](http://www.iocoder.cn/RocketMQ/message-schedule-and-retry/) ã€‚

## å¤šæ¬¡æ¶ˆè´¹å¤±è´¥åï¼Œæ€ä¹ˆåŠï¼Ÿ

é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ä¸€æ¡æ¶ˆæ¯è¢«æ¶ˆè´¹å¤±è´¥ 16 æ¬¡åï¼Œä¼šè¢«å­˜å‚¨åˆ° Topic ä¸º `"%DLQ%"` + ConsumerGroup åˆ°æ­»ä¿¡é˜Ÿåˆ—ã€‚

ä¸ºä»€ä¹ˆ Topic æ˜¯ `"%DLQ%"` + ConsumerGroup å‘¢ï¼Ÿå› ä¸ºï¼Œæ˜¯è¿™ä¸ª ConsumerGroup å¯¹æ¶ˆæ¯çš„æ¶ˆè´¹å¤±è´¥ï¼Œæ‰€ä»¥ Topic é‡Œè¦ä»¥ ConsumerGroup ä¸ºç»´åº¦ã€‚

åç»­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¢é˜… `"%DLQ%"` + ConsumerGroup ï¼Œåšç›¸åº”çš„å‘Šè­¦ã€‚

## ä»€ä¹ˆæ˜¯äº‹åŠ¡æ¶ˆæ¯ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿ

å…³äºäº‹åŠ¡æ¶ˆæ¯çš„æ¦‚å¿µå’ŒåŸç†ï¼Œèƒ–å‹å¯ä»¥çœ‹çœ‹å®˜æ–¹å¯¹è¿™å—çš„è§£ç­”ï¼Œå³ [ã€ŠRocketMQ 4.3 æ­£å¼å‘å¸ƒï¼Œæ”¯æŒåˆ†å¸ƒå¼äº‹åŠ¡ã€‹](https://www.infoq.cn/article/2018%2F08%2Frocketmq-4.3-release) çš„ [ã€Œå›› äº‹åŠ¡æ¶ˆæ¯ã€](http://svip.iocoder.cn/RocketMQ/Interview/#) å°èŠ‚ã€‚

è‰¿è‰¿ 16 å¹´çš„æ—¶å€™ï¼ŒåŸºäº RocketMQ æ—©æœŸçš„ç‰ˆæœ¬ï¼Œå†™äº† [ã€ŠRocketMQ æºç åˆ†æ â€”â€” äº‹åŠ¡æ¶ˆæ¯ã€‹](http://www.iocoder.cn/RocketMQ/message-transaction/) æ–‡ç« ï¼Œè™½ç„¶ RocketMQ ç‰ˆæœ¬ä¸å¤ªä¸€æ ·ï¼Œä½†æ˜¯å¤§ä½“çš„æ€è·¯æ˜¯å·®ä¸å¤šçš„ï¼Œå¯ä»¥å¸®åŠ©èƒ–å‹æ›´å®¹æ˜“çš„è¯»æ‡‚äº‹åŠ¡æ¶ˆæ¯ç›¸å…³çš„æºç ã€‚

- ç®€å•çœ‹äº†ä¸‹æœ€æ–°ç‰ˆæœ¬çš„ RocketMQ çš„äº‹åŠ¡ä»£ç ï¼Œæ–°å¢äº†

   

  ```
  RMQ_SYS_TRANS_HALF_TOPIC
  ```

   

  å’Œ

   

  ```
  RMQ_SYS_TRANS_OP_HALF_TOPIC
  ```

   

  ä¸¤ä¸ªé˜Ÿåˆ—ã€‚

  - Producer å‘é€ PREPARED Message åˆ° Broker åï¼Œå…ˆå­˜å‚¨åˆ° `RMQ_SYS_TRANS_HALF_TOPIC` é˜Ÿåˆ—ä¸­ã€‚
  - Producer æäº¤æˆ–å›æ»š PREPARED Message æ—¶ï¼Œä¼šæ·»åŠ ä¸€æ¡æ¶ˆæ¯åˆ° `RMQ_SYS_TRANS_OP_HALF_TOPIC` é˜Ÿåˆ—ä¸­ï¼Œæ ‡è®°è¿™ä¸ªæ¶ˆæ¯å·²ç»å¤„ç†ã€‚
  - Producer æäº¤ PREPARED Message æ—¶ï¼Œä¼šå°†å½“å‰æ¶ˆæ¯å­˜å‚¨åˆ°åŸ Topic çš„é˜Ÿåˆ—ä¸­ï¼Œä»è€Œè¯¥æ¶ˆæ¯èƒ½å¤Ÿè¢« Consumer æ‹‰å–æ¶ˆè´¹ã€‚

## å¦‚ä½•å®ç° RocketMQ é«˜å¯ç”¨ï¼Ÿ

åœ¨ [ã€ŒRocketMQ ç”±å“ªäº›è§’è‰²ç»„æˆï¼Ÿã€](http://svip.iocoder.cn/RocketMQ/Interview/#) ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ° RocketMQ æœ‰å››ä¸ªè§’è‰²ï¼Œéœ€è¦è€ƒè™‘æ¯ä¸ªè§’è‰²çš„é«˜å¯ç”¨ã€‚

![RocketMQ é›†ç¾¤](http://static.iocoder.cn/images/RocketMQ/2019_11_12/02.png)

ğŸ¦… **1. Producer**

- 1ã€Producer è‡ªèº«åœ¨åº”ç”¨ä¸­ï¼Œæ‰€ä»¥æ— éœ€è€ƒè™‘é«˜å¯ç”¨ã€‚
- 2ã€Producer é…ç½®å¤šä¸ª Namesrv åˆ—è¡¨ï¼Œä»è€Œä¿è¯ Producer å’Œ Namesrv çš„è¿æ¥é«˜å¯ç”¨ã€‚å¹¶ä¸”ï¼Œä¼šä» Namesrv å®šæ—¶æ‹‰å–æœ€æ–°çš„ Topic ä¿¡æ¯ã€‚
- 3ã€Producer ä¼šå’Œæ‰€æœ‰ Consumer ç›´è¿ï¼Œåœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œä¼šé€‰æ‹©ä¸€ä¸ª Broker è¿›è¡Œå‘é€ã€‚å¦‚æœå‘é€å¤±è´¥ï¼Œåˆ™ä¼šä½¿ç”¨å¦å¤–ä¸€ä¸ª Broker ã€‚
- 4ã€Producer ä¼šå®šæ—¶å‘ Broker å¿ƒè·³ï¼Œè¯æ˜å…¶å­˜æ´»ã€‚è€Œ Broker ä¼šå®šæ—¶æ£€æµ‹ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰ Producer å¼‚å¸¸ä¸‹çº¿ã€‚

ğŸ¦… **2. Consumer**

- 1ã€Consumer éœ€è¦éƒ¨ç½²å¤šä¸ªèŠ‚ç‚¹ï¼Œä»¥ä¿è¯ Consumer è‡ªèº«çš„é«˜å¯ç”¨ã€‚å½“ç›¸åŒæ¶ˆè´¹è€…åˆ†ç»„ä¸­æœ‰æ–°çš„ Consumer ä¸Šçº¿ï¼Œæˆ–è€…è€çš„ Consumer ä¸‹çº¿ï¼Œä¼šé‡æ–°åˆ†é… Topic çš„ Queue åˆ°ç›®å‰æ¶ˆè´¹åˆ†ç»„çš„ Consumer ä»¬ã€‚
- 2ã€Consumer é…ç½®å¤šä¸ª Namesrv åˆ—è¡¨ï¼Œä»è€Œä¿è¯ Consumer å’Œ Namesrv çš„è¿æ¥é«˜å¯ç”¨ã€‚å¹¶ä¸”ï¼Œä¼šä» Consumer å®šæ—¶æ‹‰å–æœ€æ–°çš„ Topic ä¿¡æ¯ã€‚
- 3ã€Consumer ä¼šå’Œæ‰€æœ‰ Consumer ç›´è¿ï¼Œæ¶ˆè´¹ç›¸åº”åˆ†é…åˆ°çš„ Queue çš„æ¶ˆæ¯ã€‚å¦‚æœæ¶ˆè´¹å¤±è´¥ï¼Œåˆ™ä¼šå‘å›æ¶ˆæ¯åˆ° Broker ä¸­ã€‚
- 4ã€Consumer ä¼šå®šæ—¶å‘ Broker å¿ƒè·³ï¼Œè¯æ˜å…¶å­˜æ´»ã€‚è€Œ Broker ä¼šå®šæ—¶æ£€æµ‹ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰ Consumer å¼‚å¸¸ä¸‹çº¿ã€‚

ğŸ¦… **3. Namesrv**

- 1ã€Namesrv éœ€è¦éƒ¨ç½²å¤šä¸ªèŠ‚ç‚¹ï¼Œä»¥ä¿è¯ Namesrv çš„é«˜å¯ç”¨ã€‚
- 2ã€Namesrv æœ¬èº«æ˜¯æ— çŠ¶æ€ï¼Œä¸äº§ç”Ÿæ•°æ®çš„å­˜å‚¨ï¼Œæ˜¯é€šè¿‡ Broker å¿ƒè·³å°† Topic ä¿¡æ¯åŒæ­¥åˆ° Namesrv ä¸­ã€‚
- 3ã€å¤šä¸ª Namesrv ä¹‹é—´ä¸ä¼šæœ‰æ•°æ®çš„åŒæ­¥ï¼Œæ˜¯é€šè¿‡ Broker å‘å¤šä¸ª Namesrv å¤šå†™ã€‚

ğŸ¦… **4. Broker**

- 1ã€å¤šä¸ª Broker å¯ä»¥å½¢æˆä¸€ä¸ª Broker åˆ†ç»„ã€‚æ¯ä¸ª Broker åˆ†ç»„å­˜åœ¨ä¸€ä¸ª Master å’Œå¤šä¸ª Slave èŠ‚ç‚¹ã€‚
  - Master èŠ‚ç‚¹ï¼Œå¯æä¾›è¯»å’Œå†™åŠŸèƒ½ã€‚Slave èŠ‚ç‚¹ï¼Œå¯æä¾›è¯»åŠŸèƒ½ã€‚
  - Master èŠ‚ç‚¹ä¼šä¸æ–­å‘é€æ–°çš„ CommitLog ç»™ SlaveèŠ‚ç‚¹ã€‚Slave èŠ‚ç‚¹ä¸æ–­ä¸ŠæŠ¥æœ¬åœ°çš„ CommitLog å·²ç»åŒæ­¥åˆ°çš„ä½ç½®ç»™ Master èŠ‚ç‚¹ã€‚
  - Slave èŠ‚ç‚¹ä¼šä» Master èŠ‚ç‚¹æ‹‰å–æ¶ˆè´¹è¿›åº¦ã€Topic é…ç½®ç­‰ç­‰ã€‚
- 2ã€å¤šä¸ª Broker åˆ†ç»„ï¼Œå½¢æˆ Broker é›†ç¾¤ã€‚
  - Broker é›†ç¾¤å’Œé›†ç¾¤ä¹‹é—´ï¼Œä¸å­˜åœ¨é€šä¿¡ä¸æ•°æ®åŒæ­¥ã€‚
- 3ã€Broker å¯ä»¥é…ç½®åŒæ­¥åˆ·ç›˜æˆ–å¼‚æ­¥åˆ·ç›˜ï¼Œæ ¹æ®æ¶ˆæ¯çš„æŒä¹…åŒ–çš„å¯é æ€§æ¥é…ç½®ã€‚

ğŸ¦… **æ€»ç»“**

ç›®å‰å®˜æ–¹æä¾›ä¸‰å¥—é…ç½®ï¼š

- **2m-2s-async**

| brokerClusterName | brokerName | brokerRole   | brokerId |
| ----------------- | ---------- | ------------ | -------- |
| DefaultCluster    | broker-a   | ASYNC_MASTER | 0        |
| DefaultCluster    | broker-a   | SLAVE        | 1        |
| DefaultCluster    | broker-b   | ASYNC_MASTER | 0        |
| DefaultCluster    | broker-b   | SLAVE        | 1        |

- **2m-2s-sync**

| brokerClusterName | brokerName | brokerRole  | brokerId |
| ----------------- | ---------- | ----------- | -------- |
| DefaultCluster    | broker-a   | SYNC_MASTER | 0        |
| DefaultCluster    | broker-a   | SLAVE       | 1        |
| DefaultCluster    | broker-b   | SYNC_MASTER | 0        |
| DefaultCluster    | broker-b   | SLAVE       | 1        |

- **2m-noslave**

| brokerClusterName | brokerName | brokerRole   | brokerId |
| ----------------- | ---------- | ------------ | -------- |
| DefaultCluster    | broker-a   | ASYNC_MASTER | 0        |
| DefaultCluster    | broker-b   | ASYNC_MASTER | 0        |

ç›¸å…³çš„æºç è§£æï¼Œèƒ–å‹å¯ä»¥çœ‹çœ‹ [ã€ŠRocketMQ æºç åˆ†æ â€”â€” é«˜å¯ç”¨ã€‹](http://www.iocoder.cn/RocketMQ/high-availability/) ã€‚

## RocketMQ æ˜¯å¦ä¼šå¼„ä¸¢æ•°æ®ï¼Ÿ

> è‰¿è‰¿ï¼šæ³¨æ„ï¼ŒRocketMQ æ˜¯å¦ä¼šä¸¢æ•°æ®ï¼Œä¸»è¦å–å†³äºæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨ã€‚è¿™ç‚¹ï¼Œéå¸¸é‡è¦å™¢ã€‚

ğŸ¦… **æ¶ˆè´¹ç«¯å¼„ä¸¢äº†æ•°æ®ï¼Ÿ**

å¯¹äºæ¶ˆè´¹ç«¯ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä½¿ç”¨ Push æ¨¡å¼çš„æƒ…å†µä¸‹ï¼Œåªæœ‰æˆ‘ä»¬æ¶ˆè´¹è¿”å›æˆåŠŸï¼Œæ‰ä¼šå¼‚æ­¥å®šæœŸæ›´æ–°æ¶ˆè´¹è¿›åº¦åˆ° Broker ä¸Šã€‚

å¦‚æœæ¶ˆè´¹ç«¯å¼‚å¸¸å´©æºƒï¼Œå¯èƒ½å¯¼è‡´æ¶ˆè´¹è¿›åº¦æœªæ›´æ–°åˆ° Broker ä¸Šï¼Œé‚£ä¹ˆæ— éæ˜¯ Consumer å¯èƒ½é‡å¤æ‹‰å–åˆ°å·²ç»æ¶ˆè´¹è¿‡çš„æ¶ˆæ¯ã€‚å…³äºè¿™ä¸ªï¼Œå°±éœ€è¦æ¶ˆè´¹ç«¯åšå¥½æ¶ˆè´¹çš„å¹‚ç­‰æ€§ã€‚

ğŸ¦… **Broker å¼„ä¸¢äº†æ•°æ®ï¼Ÿ**

åœ¨ä¸Šé¢çš„é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº† Broker æä¾›äº†ä¸¤ä¸ªç‰¹æ€§ï¼š

- åˆ·ç›˜æ–¹å¼ï¼šåŒæ­¥åˆ·ç›˜ã€å¼‚æ­¥åˆ·ç›˜ã€‚
- å¤åˆ¶æ–¹å¼ï¼šåŒæ­¥å¤åˆ¶ã€å¼‚æ­¥å¤åˆ¶ã€‚

å¦‚æœè¦ä¿è¯ Broker æ•°æ®æœ€å¤§åŒ–çš„ä¸ä¸¢ï¼Œéœ€è¦åœ¨æ­å»º Broker é›†ç¾¤æ—¶ï¼Œè®¾ç½®ä¸ºåŒæ­¥åˆ·ç›˜ã€åŒæ­¥å¤åˆ¶ã€‚å½“ç„¶ï¼Œå¸¦æ¥äº†å¯é æ€§ï¼Œä¹Ÿä¼šä¸€å®šç¨‹åº¦é™ä½æ€§èƒ½ã€‚

å¦‚æœæƒ³è¦åœ¨å¯é æ€§å’Œæ€§èƒ½ä¹‹é—´åšä¸€ä¸ªå¹³è¡¡ï¼Œå¯ä»¥é€‰æ‹©åŒæ­¥å¤åˆ¶ï¼ŒåŠ ä¸»ä» Broker éƒ½æ˜¯å’Œå¼‚æ­¥åˆ·ç›˜ã€‚å› ä¸ºï¼Œåˆ·ç›˜æ¯”è¾ƒæ¶ˆè€—æ€§èƒ½ã€‚

ğŸ¦… **ç”Ÿäº§è€…ä¼šä¸ä¼šå¼„ä¸¢æ•°æ®ï¼Ÿ**

Producer å¯ä»¥è®¾ç½®ä¸‰æ¬¡å‘é€æ¶ˆæ¯é‡è¯•ã€‚

## å¦‚ä½•ä¿è¯æ¶ˆè´¹è€…çš„æ¶ˆè´¹æ¶ˆæ¯çš„å¹‚ç­‰æ€§ï¼Ÿ

åœ¨ [ã€Šç²¾å°½ã€æ¶ˆæ¯é˜Ÿåˆ— ã€‘é¢è¯•é¢˜ã€‹](http://svip.iocoder.cn/MQ/Interview) ä¸­ï¼Œå·²ç»è§£æè¿‡è¯¥é—®é¢˜ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬æœ‰å‡ ç‚¹è¦è¡¥å……ä¸‹ï¼š

- Producer åœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œé»˜è®¤ä¼šç”Ÿæˆæ¶ˆæ¯ç¼–å·( `msgId` )ï¼Œå¯è§ `org.apache.rocketmq.common.message.MessageClientExt` ç±»ã€‚
- Broker åœ¨å­˜å‚¨æ¶ˆæ¯æ—¶ï¼Œä¼šç”Ÿæˆç»“åˆ offset çš„æ¶ˆæ¯ç¼–å·( `offsetMsgId` ) ã€‚
- Consumer åœ¨æ¶ˆè´¹æ¶ˆæ¯å¤±è´¥åï¼Œå°†è¯¥æ¶ˆæ¯å‘å› Broker åï¼Œä¼šäº§ç”Ÿæ–°çš„ `offsetMsgId` ç¼–å·ï¼Œä½†æ˜¯ `msgId` ä¸å˜ã€‚

## é‡ç‚¹è¡¥å……è¯´æ˜

RocketMQ æ¶‰åŠçš„å†…å®¹å¾ˆå¤šï¼Œèƒ½å¤Ÿé—®çš„é—®é¢˜ä¹Ÿç‰¹åˆ«å¤šï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ä»…ä»…ä¸ºäº†é¢è¯•ï¼Œåº”è¯¥æ˜¯ä¸ºäº†å¯¹ RocketMQ äº†è§£æ›´å¤šï¼Œä½¿ç”¨çš„æ›´ä¼˜é›…ã€‚æ‰€ä»¥ï¼Œå¼ºçƒˆèƒ–å‹è®¤çœŸæ’¸ä¸‹å¦‚ä¸‹ä¸‰ä¸ª PDF ï¼š

- [ã€ŠRocketMQ ç”¨æˆ·æŒ‡å—ã€‹](http://gd-rus-public.cn-hangzhou.oss-pub.aliyun-inc.com/attachment/201604/08/20160408164726/RocketMQ_userguide.pdf) åŸºäº RocketMQ 3 çš„ç‰ˆæœ¬ã€‚
- [ã€ŠRocketMQ åŸç†ç®€ä»‹ã€‹](http://alibaba.github.io/RocketMQ-docs/document/design/RocketMQ_design.pdf) åŸºäº RocketMQ 3 çš„ç‰ˆæœ¬ã€‚
- [ã€ŠRocketMQ æœ€ä½³å®è·µã€‹](http://gd-rus-public.cn-hangzhou.oss-pub.aliyun-inc.com/attachment/201604/08/20160408164929/RocketMQ_experience.pdf) åŸºäº RocketMQ 3 çš„ç‰ˆæœ¬ã€‚

## 666. å½©è›‹

RocketMQ èƒ½å¤Ÿé—®çš„ä¸œè¥¿ï¼ŒçœŸçš„æŒºå¤šçš„ï¼Œä¸­é—´ä¹Ÿå’Œä¸€äº›æœ‹å‹æ¢è®¨è¿‡ã€‚å¦‚æœèƒ–å‹æœ‰ä»€ä¹ˆæƒ³è¦é—®çš„ï¼Œå¯ä»¥åœ¨æ˜Ÿçƒç»™è‰¿è‰¿ç•™è¨€ã€‚

å‚è€ƒä¸æ¨èå¦‚ä¸‹æ–‡ç« ï¼š

- javahongxi [ã€ŠRocketMQ æ¶æ„æ¨¡å—è§£æã€‹](https://blog.csdn.net/javahongxi/article/details/72956608)
- è–›å®šè°”çš„é£å£çŒª [ã€ŠRocketMQ â€”â€” è§’è‰²ä¸æœ¯è¯­è¯¦è§£ã€‹](http://jaskey.github.io/blog/2016/12/15/rocketmq-concept/)
- é˜¿é‡Œä¸­é—´ä»¶å°å“¥ [ã€Šä¸€æ–‡è®²é€ Apache RocketMQ æŠ€æœ¯ç²¾åã€‹](http://www.10tiao.com/html/683/201811/2650718577/1.html)



- [é¢è¯•é¢˜](javascript:void(0))







1. [RocketMQ æ˜¯ä»€ä¹ˆï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#RocketMQ-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F)
2. [RocketMQ ç”±å“ªäº›è§’è‰²ç»„æˆï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#RocketMQ-%E7%94%B1%E5%93%AA%E4%BA%9B%E8%A7%92%E8%89%B2%E7%BB%84%E6%88%90%EF%BC%9F)
3. [è¯·æè¿°ä¸‹ RocketMQ çš„æ•´ä½“æµç¨‹ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E8%AF%B7%E6%8F%8F%E8%BF%B0%E4%B8%8B-RocketMQ-%E7%9A%84%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B%EF%BC%9F)
4. [è¯·è¯´è¯´ä½ å¯¹ Namesrv çš„äº†è§£ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E8%AF%B7%E8%AF%B4%E8%AF%B4%E4%BD%A0%E5%AF%B9-Namesrv-%E7%9A%84%E4%BA%86%E8%A7%A3%EF%BC%9F)
5. [å¦‚ä½•é…ç½® Namesrv åœ°å€åˆ°ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AE-Namesrv-%E5%9C%B0%E5%9D%80%E5%88%B0%E7%94%9F%E4%BA%A7%E8%80%85%E5%92%8C%E6%B6%88%E8%B4%B9%E8%80%85%EF%BC%9F)
6. [è¯·è¯´è¯´ä½ å¯¹ Broker çš„äº†è§£ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E8%AF%B7%E8%AF%B4%E8%AF%B4%E4%BD%A0%E5%AF%B9-Broker-%E7%9A%84%E4%BA%86%E8%A7%A3%EF%BC%9F)
7. [Broker å¦‚ä½•å®ç°æ¶ˆæ¯çš„å­˜å‚¨ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#Broker-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E6%B6%88%E6%81%AF%E7%9A%84%E5%AD%98%E5%82%A8%EF%BC%9F)
8. [è¯·è¯´è¯´ä½ å¯¹ Producer çš„äº†è§£ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E8%AF%B7%E8%AF%B4%E8%AF%B4%E4%BD%A0%E5%AF%B9-Producer-%E7%9A%84%E4%BA%86%E8%A7%A3%EF%BC%9F)
9. [Producer å‘é€æ¶ˆæ¯æœ‰å‡ ç§æ–¹å¼ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#Producer-%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF%E6%9C%89%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F%EF%BC%9F)
10. [è¯·è¯´è¯´ä½ å¯¹ Consumer çš„äº†è§£ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E8%AF%B7%E8%AF%B4%E8%AF%B4%E4%BD%A0%E5%AF%B9-Consumer-%E7%9A%84%E4%BA%86%E8%A7%A3%EF%BC%9F)
11. [æ¶ˆè´¹è€…æ¶ˆè´¹æ¨¡å¼æœ‰å‡ ç§ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E6%B6%88%E8%B4%B9%E8%80%85%E6%B6%88%E8%B4%B9%E6%A8%A1%E5%BC%8F%E6%9C%89%E5%87%A0%E7%A7%8D%EF%BC%9F)
12. [æ¶ˆè´¹è€…è·å–æ¶ˆæ¯æœ‰å‡ ç§æ¨¡å¼ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E6%B6%88%E8%B4%B9%E8%80%85%E8%8E%B7%E5%8F%96%E6%B6%88%E6%81%AF%E6%9C%89%E5%87%A0%E7%A7%8D%E6%A8%A1%E5%BC%8F%EF%BC%9F)
13. [å¦‚ä½•å¯¹æ¶ˆæ¯è¿›è¡Œé‡æ”¾ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E5%A6%82%E4%BD%95%E5%AF%B9%E6%B6%88%E6%81%AF%E8%BF%9B%E8%A1%8C%E9%87%8D%E6%94%BE%EF%BC%9F)
14. [ä»€ä¹ˆæ˜¯é¡ºåºæ¶ˆæ¯ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E4%BB%80%E4%B9%88%E6%98%AF%E9%A1%BA%E5%BA%8F%E6%B6%88%E6%81%AF%EF%BC%9F%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%EF%BC%9F)
15. [é¡ºåºæ¶ˆæ¯æ‰©å®¹çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•åœ¨ä¸åœå†™çš„æƒ…å†µä¸‹ä¿è¯æ¶ˆæ¯é¡ºåºï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E9%A1%BA%E5%BA%8F%E6%B6%88%E6%81%AF%E6%89%A9%E5%AE%B9%E7%9A%84%E8%BF%87%E7%A8%8B%E4%B8%AD%EF%BC%8C%E5%A6%82%E4%BD%95%E5%9C%A8%E4%B8%8D%E5%81%9C%E5%86%99%E7%9A%84%E6%83%85%E5%86%B5%E4%B8%8B%E4%BF%9D%E8%AF%81%E6%B6%88%E6%81%AF%E9%A1%BA%E5%BA%8F%EF%BC%9F)
16. [ä»€ä¹ˆæ˜¯å®šæ—¶æ¶ˆæ¯ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AE%9A%E6%97%B6%E6%B6%88%E6%81%AF%EF%BC%9F%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%EF%BC%9F)
17. [ä»€ä¹ˆæ˜¯æ¶ˆæ¯é‡è¯•ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E4%BB%80%E4%B9%88%E6%98%AF%E6%B6%88%E6%81%AF%E9%87%8D%E8%AF%95%EF%BC%9F%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%EF%BC%9F)
18. [å¤šæ¬¡æ¶ˆè´¹å¤±è´¥åï¼Œæ€ä¹ˆåŠï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E5%A4%9A%E6%AC%A1%E6%B6%88%E8%B4%B9%E5%A4%B1%E8%B4%A5%E5%90%8E%EF%BC%8C%E6%80%8E%E4%B9%88%E5%8A%9E%EF%BC%9F)
19. [ä»€ä¹ˆæ˜¯äº‹åŠ¡æ¶ˆæ¯ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%8B%E5%8A%A1%E6%B6%88%E6%81%AF%EF%BC%9F%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%EF%BC%9F)
20. [å¦‚ä½•å®ç° RocketMQ é«˜å¯ç”¨ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0-RocketMQ-%E9%AB%98%E5%8F%AF%E7%94%A8%EF%BC%9F)
21. [RocketMQ æ˜¯å¦ä¼šå¼„ä¸¢æ•°æ®ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#RocketMQ-%E6%98%AF%E5%90%A6%E4%BC%9A%E5%BC%84%E4%B8%A2%E6%95%B0%E6%8D%AE%EF%BC%9F)
22. [å¦‚ä½•ä¿è¯æ¶ˆè´¹è€…çš„æ¶ˆè´¹æ¶ˆæ¯çš„å¹‚ç­‰æ€§ï¼Ÿ](http://svip.iocoder.cn/RocketMQ/Interview/#%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E6%B6%88%E8%B4%B9%E8%80%85%E7%9A%84%E6%B6%88%E8%B4%B9%E6%B6%88%E6%81%AF%E7%9A%84%E5%B9%82%E7%AD%89%E6%80%A7%EF%BC%9F)
23. [é‡ç‚¹è¡¥å……è¯´æ˜](http://svip.iocoder.cn/RocketMQ/Interview/#%E9%87%8D%E7%82%B9%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E)
24. [666. å½©è›‹](http://svip.iocoder.cn/RocketMQ/Interview/#666-%E5%BD%A9%E8%9B%8B)

Â© 2019 èŠ‹é“æºç 

[Hexo](http://hexo.io/) Theme [Yilia](https://github.com/litten/hexo-theme-yilia) by Litten

æ€»è®¿å®¢æ•° 88005 æ¬¡

 

&&

 

æ€»è®¿é—®é‡ 575379 æ¬¡


  