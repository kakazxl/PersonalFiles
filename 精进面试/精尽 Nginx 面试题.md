# ç²¾å°½ Nginx é¢è¯•é¢˜



ä»¥ä¸‹é¢è¯•é¢˜ï¼ŒåŸºäºç½‘ç»œæ•´ç†ï¼Œå’Œè‡ªå·±ç¼–è¾‘ã€‚å…·ä½“å‚è€ƒçš„æ–‡ç« ï¼Œä¼šåœ¨æ–‡æœ«ç»™å‡ºæ‰€æœ‰çš„é“¾æ¥ã€‚

å¦‚æœèƒ–å‹æœ‰è‡ªå·±çš„ç–‘é—®ï¼Œæ¬¢è¿åœ¨æ˜Ÿçƒæé—®ï¼Œæˆ‘ä»¬ä¸€èµ·æ•´ç†åŠåŠçš„ Nginx é¢è¯•é¢˜çš„å¤§ä¿å¥ã€‚

è€Œé¢˜ç›®çš„éš¾åº¦ï¼Œè‰¿è‰¿å°½é‡æŒ‰ç…§ä»å®¹æ˜“åˆ°å›°éš¾çš„é¡ºåºï¼Œé€æ­¥ä¸‹å»ã€‚

## è¯·è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯ Nginx ï¼Ÿ

Nginx ï¼Œæ˜¯ä¸€ä¸ª Web æœåŠ¡å™¨å’Œåå‘ä»£ç†æœåŠ¡å™¨ï¼Œç”¨äº HTTPã€HTTPSã€SMTPã€POP3 å’Œ IMAP åè®®ã€‚

ç›®å‰ä½¿ç”¨çš„æœ€å¤šçš„ Web æœåŠ¡å™¨æˆ–è€…ä»£ç†æœåŠ¡å™¨ï¼Œåƒæ·˜å®ã€æ–°æµªã€ç½‘æ˜“ã€è¿…é›·ç­‰éƒ½åœ¨ä½¿ç”¨ã€‚

Nginx çš„ä¸»è¦åŠŸèƒ½å¦‚ä¸‹ï¼š

- ä½œä¸º http server (ä»£æ›¿ Apache ï¼Œå¯¹ PHP éœ€è¦ FastCGI å¤„ç†å™¨æ”¯æŒ)

  > FastCGIï¼šNginx æœ¬èº«ä¸æ”¯æŒ PHP ç­‰è¯­è¨€ï¼Œä½†æ˜¯å®ƒå¯ä»¥é€šè¿‡ FastCGI æ¥å°†è¯·æ±‚æ‰”ç»™æŸäº›è¯­è¨€æˆ–æ¡†æ¶å¤„ç†ã€‚

- åå‘ä»£ç†æœåŠ¡å™¨

- å®ç°è´Ÿè½½å‡è¡¡

- è™šæ‹Ÿä¸»æœº

ğŸ¦… **fastcgi ä¸ cgi çš„åŒºåˆ«ï¼Ÿ**

1ï¼‰cgi

> web æœåŠ¡å™¨ä¼šæ ¹æ®è¯·æ±‚çš„å†…å®¹ï¼Œç„¶åä¼š fork ä¸€ä¸ªæ–°è¿›ç¨‹æ¥è¿è¡Œå¤–éƒ¨ c ç¨‹åºï¼ˆæˆ– perl è„šæœ¬â€¦ï¼‰ï¼Œ è¿™ä¸ªè¿›ç¨‹ä¼šæŠŠå¤„ç†å®Œçš„æ•°æ®è¿”å›ç»™ web æœåŠ¡å™¨ï¼Œæœ€å web æœåŠ¡å™¨æŠŠå†…å®¹å‘é€ç»™ç”¨æˆ·ï¼Œåˆšæ‰ fork çš„è¿›ç¨‹ä¹Ÿéšä¹‹é€€å‡ºã€‚
>
> å¦‚æœä¸‹æ¬¡ç”¨æˆ·è¿˜è¯·æ±‚æ”¹åŠ¨æ€è„šæœ¬ï¼Œé‚£ä¹ˆ web æœåŠ¡å™¨åˆå†æ¬¡ fork ä¸€ä¸ªæ–°è¿›ç¨‹ï¼Œå‘¨è€Œå¤å§‹çš„è¿›è¡Œã€‚

2ï¼‰fastcgi

> web æœåŠ¡å™¨æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œä»–ä¸ä¼šé‡æ–° fork ä¸€ä¸ªè¿›ç¨‹ï¼ˆå› ä¸ºè¿™ä¸ªè¿›ç¨‹åœ¨ web æœåŠ¡å™¨å¯åŠ¨æ—¶å°±å¼€å¯äº†ï¼Œè€Œä¸”ä¸ä¼šé€€å‡ºï¼‰ï¼Œweb æœåŠ¡å™¨ç›´æ¥æŠŠå†…å®¹ä¼ é€’ç»™è¿™ä¸ªè¿›ç¨‹ï¼ˆè¿›ç¨‹é—´é€šä¿¡ï¼Œä½† fastcgi ä½¿ç”¨äº†åˆ«çš„æ–¹å¼ï¼Œtcp æ–¹å¼é€šä¿¡ï¼‰ï¼Œè¿™ä¸ªè¿›ç¨‹æ”¶åˆ°è¯·æ±‚åè¿›è¡Œå¤„ç†ï¼ŒæŠŠç»“æœè¿”å›ç»™ web æœåŠ¡å™¨ï¼Œæœ€åè‡ªå·±æ¥ç€ç­‰å¾…ä¸‹ä¸€ä¸ªè¯·æ±‚çš„åˆ°æ¥ï¼Œè€Œä¸æ˜¯é€€å‡ºã€‚

ğŸš€ ç»¼ä¸Šï¼Œå·®åˆ«åœ¨äºæ˜¯å¦é‡å¤ fork è¿›ç¨‹ï¼Œå¤„ç†è¯·æ±‚ã€‚

å…³äº Nginx å’Œ fastcgi æ˜¯å¦‚ä½•è¿è¡Œçš„ï¼Œå¯ä»¥çœ‹çœ‹ [ã€ŠNginx + FastCGIè¿è¡ŒåŸç†ã€‹](https://www.linuxba.com/archives/7682) ã€‚

åŒæ ·ï¼Œå…³äº cgi å¯èƒ½ä¹Ÿä¼šå­˜åœ¨ [ã€Šphp é¢è¯•é¢˜äº”ä¹‹ nginx å¦‚ä½•è°ƒç”¨ php å’Œ php-fpm çš„ä½œç”¨å’Œå·¥ä½œåŸç†ã€‹](https://phperzh.com/articles/7297) é—®é¢˜ã€‚

## Nginx å¸¸ç”¨å‘½ä»¤ï¼Ÿ

- å¯åŠ¨ `nginx` ã€‚
- åœæ­¢ `nginx -s stop` æˆ– `nginx -s quit` ã€‚
- é‡è½½é…ç½® `./sbin/nginx -s reload(å¹³æ»‘é‡å¯)` æˆ– `service nginx reload` ã€‚
- é‡è½½æŒ‡å®šé…ç½®æ–‡ä»¶ `.nginx -c /usr/local/nginx/conf/nginx.conf` ã€‚
- æŸ¥çœ‹ nginx ç‰ˆæœ¬ `nginx -v` ã€‚
- æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡® `nginx -t` ã€‚
- æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ `nginx -h` ã€‚

## Nginx å¸¸ç”¨é…ç½®ï¼Ÿ

```
worker_processes  8; # å·¥ä½œè¿›ç¨‹ä¸ªæ•°
worker_connections  65535; # æ¯ä¸ªå·¥ä½œè¿›ç¨‹èƒ½å¹¶å‘å¤„ç†ï¼ˆå‘èµ·ï¼‰çš„æœ€å¤§è¿æ¥æ•°ï¼ˆåŒ…å«æ‰€æœ‰è¿æ¥æ•°ï¼‰
error_log         /data/logs/nginx/error.log; # é”™è¯¯æ—¥å¿—æ‰“å°åœ°å€
access_log      /data/logs/nginx/access.log; # è¿›å…¥æ—¥å¿—æ‰“å°åœ°å€
log_format  main  '$remote_addr"$request" ''$status $upstream_addr "$request_time"'; # è¿›å…¥æ—¥å¿—æ ¼å¼

## å¦‚æœæœªä½¿ç”¨ fastcgi åŠŸèƒ½çš„ï¼Œå¯ä»¥æ— è§†
fastcgi_connect_timeout=300; # è¿æ¥åˆ°åç«¯ fastcgi è¶…æ—¶æ—¶é—´
fastcgi_send_timeout=300; # å‘ fastcgi è¯·æ±‚è¶…æ—¶æ—¶é—´(è¿™ä¸ªæŒ‡å®šå€¼å·²ç»å®Œæˆä¸¤æ¬¡æ¡æ‰‹åå‘fastcgiä¼ é€è¯·æ±‚çš„è¶…æ—¶æ—¶é—´)
fastcgi_rend_timeout=300; # æ¥æ”¶ fastcgi åº”ç­”è¶…æ—¶æ—¶é—´ï¼ŒåŒç†ä¹Ÿæ˜¯2æ¬¡æ¡æ‰‹å
fastcgi_buffer_size=64k; # è¯»å– fastcgi åº”ç­”ç¬¬ä¸€éƒ¨åˆ†éœ€è¦å¤šå¤§ç¼“å†²åŒºï¼Œè¯¥å€¼è¡¨ç¤ºä½¿ç”¨1ä¸ª64kbçš„ç¼“å†²åŒºè¯»å–åº”ç­”ç¬¬ä¸€éƒ¨åˆ†(åº”ç­”å¤´),å¯ä»¥è®¾ç½®ä¸ºfastcgi_buffersé€‰é¡¹ç¼“å†²åŒºå¤§å°
fastcgi_buffers 4 64k; # æŒ‡å®šæœ¬åœ°éœ€è¦å¤šå°‘å’Œå¤šå¤§çš„ç¼“å†²åŒºæ¥ç¼“å†²fastcgiåº”ç­”è¯·æ±‚ï¼Œå‡è®¾ä¸€ä¸ªphpæˆ–javaè„šæœ¬æ‰€äº§ç”Ÿé¡µé¢å¤§å°ä¸º256kb,é‚£ä¹ˆä¼šä¸ºå…¶åˆ†é…4ä¸ª64kbçš„ç¼“å†²æ¥ç¼“å­˜
fastcgi_cache TEST; # å¼€å¯fastcgiç¼“å­˜å¹¶ä¸ºå…¶æŒ‡å®šä¸ºTESTåç§°ï¼Œé™ä½cpuè´Ÿè½½,é˜²æ­¢502é”™è¯¯å‘ç”Ÿ

listen       80; # ç›‘å¬ç«¯å£
server_name  rrc.test.jiedaibao.com; # å…è®¸åŸŸå
root  /data/release/rrc/web; # é¡¹ç›®æ ¹ç›®å½•
index  index.php index.html index.htm; # è®¿é—®æ ¹æ–‡ä»¶
```

ğŸ¦… **Nginx æ—¥å¿—æ ¼å¼ä¸­çš„ $time_local è¡¨ç¤ºçš„æ˜¯ä»€ä¹ˆæ—¶é—´ï¼Ÿè¯·æ±‚å¼€å§‹çš„æ—¶é—´ï¼Ÿè¯·æ±‚ç»“æŸçš„æ—¶é—´ï¼Ÿå…¶æ¬¡ï¼Œå½“æˆ‘ä»¬ä»å‰åˆ°åè§‚å¯Ÿæ—¥å¿—ä¸­çš„ $time_local æ—¶é—´æ—¶ï¼Œæœ‰æ—¶å€™ä¼šå‘ç°æ—¶é—´é¡ºåºå‰åé”™ä¹±çš„ç°è±¡ï¼Œè¯·è¯´æ˜åŸå› ï¼Ÿ**

`$time_local` ï¼šåœ¨æœåŠ¡å™¨é‡Œè¯·æ±‚å¼€å§‹å†™å…¥æœ¬åœ°çš„æ—¶é—´ã€‚

å› ä¸ºè¯·æ±‚å‘ç”Ÿæ—¶é—´æœ‰å‰æœ‰åï¼Œæ‰€ä»¥ä¼šæ—¶é—´é¡ºåºå‰åé”™ä¹±ã€‚

## Nginx æœ‰å“ªäº›ä¼˜ç‚¹ï¼Ÿ

- è·¨å¹³å°ã€é…ç½®ç®€å•ã€‚

- éé˜»å¡ã€é«˜å¹¶å‘è¿æ¥

  > å¤„ç† 2-3 ä¸‡å¹¶å‘è¿æ¥æ•°ï¼Œå®˜æ–¹ç›‘æµ‹èƒ½æ”¯æŒ 5 ä¸‡å¹¶å‘ã€‚

- å†…å­˜æ¶ˆè€—å°

  > å¼€å¯ 10 ä¸ª Nginx æ‰å  150M å†…å­˜ã€‚

- æˆæœ¬ä½å»‰ï¼Œä¸”å¼€æºã€‚

- ç¨³å®šæ€§é«˜ï¼Œå®•æœºçš„æ¦‚ç‡éå¸¸å°ã€‚

## ä½¿ç”¨â€œåå‘ä»£ç†æœåŠ¡å™¨â€çš„ä¼˜ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ

åå‘ä»£ç†æœåŠ¡å™¨å¯ä»¥éšè—æºæœåŠ¡å™¨çš„å­˜åœ¨å’Œç‰¹å¾ã€‚å®ƒå……å½“äº’è”ç½‘äº‘å’Œ Web æœåŠ¡å™¨ä¹‹é—´çš„ä¸­é—´å±‚ã€‚è¿™å¯¹äºå®‰å…¨æ–¹é¢æ¥è¯´æ˜¯å¾ˆå¥½çš„ï¼Œç‰¹åˆ«æ˜¯å½“æˆ‘ä»¬ä½¿ç”¨ Web æ‰˜ç®¡æœåŠ¡æ—¶ã€‚

> è¿™é‡Œï¼Œå…ˆä¸è€ƒè™‘è´Ÿè½½å‡è¡¡ã€‚

ğŸ¦… **ä»€ä¹ˆæ˜¯æ­£å‘ä»£ç†ï¼Ÿ**

ä¸€ä¸ªä½äºå®¢æˆ·ç«¯å’ŒåŸå§‹æœåŠ¡å™¨(origin server)ä¹‹é—´çš„æœåŠ¡å™¨ï¼Œä¸ºäº†ä»åŸå§‹æœåŠ¡å™¨å–å¾—å†…å®¹ï¼Œå®¢æˆ·ç«¯å‘ä»£ç†å‘é€ä¸€ä¸ªè¯·æ±‚å¹¶æŒ‡å®šç›®æ ‡(åŸå§‹æœåŠ¡å™¨)ï¼Œç„¶åä»£ç†å‘åŸå§‹æœåŠ¡å™¨è½¬äº¤è¯·æ±‚å¹¶å°†è·å¾—çš„å†…å®¹è¿”å›ç»™å®¢æˆ·ç«¯ã€‚

- å®¢æˆ·ç«¯æ‰èƒ½ä½¿ç”¨æ­£å‘ä»£ç†ã€‚
- æ­£å‘ä»£ç†æ€»ç»“å°±ä¸€å¥è¯ï¼šä»£ç†ç«¯ä»£ç†çš„æ˜¯å®¢æˆ·ç«¯ã€‚ä¾‹å¦‚è¯´ï¼šğŸ˜ˆ æˆ‘ä»¬ä½¿ç”¨çš„ç¿»å¢™è½¯ä»¶ï¼ŒOpenVPN ç­‰ç­‰ã€‚

ğŸ¦… **ä»€ä¹ˆæ˜¯åå‘ä»£ç†ï¼Ÿ**

åå‘ä»£ç†ï¼ˆReverse Proxyï¼‰æ–¹å¼ï¼Œæ˜¯æŒ‡ä»¥ä»£ç†æœåŠ¡å™¨æ¥æ¥å— Internetä¸Šçš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå°†è¯·æ±‚ï¼Œå‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨å¹¶å°†ä»æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™ Internet ä¸Šè¯·æ±‚è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶ä»£ç†æœåŠ¡å™¨å¯¹å¤–å°±è¡¨ç°ä¸ºä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨ã€‚

åå‘ä»£ç†æ€»ç»“å°±ä¸€å¥è¯ï¼šä»£ç†ç«¯ä»£ç†çš„æ˜¯æœåŠ¡ç«¯ã€‚

ğŸ¦… **è¯·åˆ—ä¸¾ Nginx å’Œ Apache ä¹‹é—´çš„ä¸åŒç‚¹ï¼Ÿ**

![å¯¹æ¯”å›¾](http://static.iocoder.cn/7bdf14ce3d607e5765e37750cc49d65f)

- è½»é‡çº§ï¼ŒåŒæ ·èµ· web æœåŠ¡ï¼ŒNginx æ¯” Apache å ç”¨æ›´å°‘çš„å†…å­˜åŠèµ„æºã€‚
- æŠ—å¹¶å‘ï¼ŒNginx å¤„ç†è¯·æ±‚æ˜¯å¼‚æ­¥éé˜»å¡çš„ï¼Œè€Œ Apache åˆ™æ˜¯é˜»å¡å‹çš„ï¼Œåœ¨é«˜å¹¶å‘ä¸‹ Nginx èƒ½ä¿æŒä½èµ„æºä½æ¶ˆè€—é«˜æ€§èƒ½ã€‚
- æœ€æ ¸å¿ƒçš„åŒºåˆ«åœ¨äº Apache æ˜¯åŒæ­¥å¤šè¿›ç¨‹æ¨¡å‹ï¼Œä¸€ä¸ªè¿æ¥å¯¹åº”ä¸€ä¸ªè¿›ç¨‹ï¼›Nginx æ˜¯å¼‚æ­¥çš„ï¼Œå¤šä¸ªè¿æ¥ï¼ˆä¸‡çº§åˆ«ï¼‰å¯ä»¥å¯¹åº”ä¸€ä¸ªè¿›ç¨‹ã€‚
- Nginx é«˜åº¦æ¨¡å—åŒ–çš„è®¾è®¡ï¼Œç¼–å†™æ¨¡å—ç›¸å¯¹ç®€å•ã€‚

ğŸ¦… **LVSã€Nginxã€HAproxy æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**

- LVS ï¼šæ˜¯åŸºäºå››å±‚çš„è½¬å‘ã€‚

- HAproxy ï¼š æ˜¯åŸºäºå››å±‚å’Œä¸ƒå±‚çš„è½¬å‘ï¼Œæ˜¯ä¸“ä¸šçš„ä»£ç†æœåŠ¡å™¨ã€‚

- Nginx ï¼šæ˜¯ WEB æœåŠ¡å™¨ï¼Œç¼“å­˜æœåŠ¡å™¨ï¼Œåˆæ˜¯åå‘ä»£ç†æœåŠ¡å™¨ï¼Œå¯ä»¥åšä¸ƒå±‚çš„è½¬å‘ã€‚

  > Nginx å¼•å…¥ [TCP æ’ä»¶](https://docs.nginx.com/nginx/admin-guide/load-balancer/tcp-udp-load-balancer/)ä¹‹åï¼Œä¹Ÿå¯ä»¥æ”¯æŒå››å±‚çš„è½¬å‘ã€‚

ğŸš€ åŒºåˆ«

LVS ç”±äºæ˜¯åŸºäºå››å±‚çš„è½¬å‘æ‰€ä»¥åªèƒ½åšç«¯å£çš„è½¬å‘ï¼Œè€ŒåŸºäº URL çš„ã€åŸºäºç›®å½•çš„è¿™ç§è½¬å‘ LVS å°±åšä¸äº†ã€‚

ğŸš€ å·¥ä½œé€‰æ‹©ï¼š

HAproxy å’Œ Nginx ç”±äºå¯ä»¥åšä¸ƒå±‚çš„è½¬å‘ï¼Œæ‰€ä»¥ URL å’Œç›®å½•çš„è½¬å‘éƒ½å¯ä»¥åšï¼Œåœ¨å¾ˆå¤§å¹¶å‘é‡çš„æ—¶å€™æˆ‘ä»¬å°±è¦é€‰æ‹© LVS ï¼Œåƒä¸­å°å‹å…¬å¸çš„è¯å¹¶å‘é‡æ²¡é‚£ä¹ˆå¤§é€‰æ‹© HAproxy æˆ–è€… Nginx è¶³å·²ã€‚

ç”±äº HAproxy ç”±æ˜¯ä¸“ä¸šçš„ä»£ç†æœåŠ¡å™¨é…ç½®ç®€å•ï¼Œæ‰€ä»¥ä¸­å°å‹ä¼ä¸šæ¨èä½¿ç”¨HAproxy ã€‚

> æœ‰äº›ä½¿ç”¨ï¼Œä½¿ç”¨ HAproxy è¿˜æ˜¯ Nginx ï¼Œä¹Ÿå’Œå…¬å¸è¿ç»´å¯¹å“ªä¸ªæŠ€æœ¯æ ˆçš„æŒæ§ç¨‹åº¦ã€‚æŒæ§ OK ï¼Œé€‰æ‹© Nginx ä¼šæ›´åŠ ä¸é”™ã€‚
>
> å¦å¤–ï¼ŒLVS + Nginx å’Œ LVS + HAProxy ä¹Ÿæ˜¯æ¯”è¾ƒå¸¸è§çš„é€‰å‹ç»„åˆã€‚

æ›´å¤šæ›´è¯¦ç»†çš„å¯¹æ¯”ï¼Œæ„Ÿå…´è¶£çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹ [ã€ŠLVSã€HAProxyã€Nginx è´Ÿè½½å‡è¡¡çš„æ¯”è¾ƒåˆ†æã€‹](https://blog.csdn.net/gzh0222/article/details/8540604) ã€‚

ğŸ¦… **Squidã€Varinshã€Nginx æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**

ä¸‰è€…éƒ½å®ç°ç¼“å­˜æœåŠ¡å™¨çš„ä½œç”¨ã€‚æ‰€ä»¥ï¼Œæœ¬é—®é¢˜æ‰€æœ‰çš„è§†è§’ï¼Œéƒ½æ˜¯åœ¨ä½œä¸ºç¼“å­˜æœåŠ¡å™¨ä¸‹æ¥èŠã€‚

- 1ã€Nginxæœ¬æ¥æ˜¯åå‘ä»£ç†/webæœåŠ¡å™¨ï¼Œç”¨äº†æ’ä»¶å¯ä»¥åšåšè¿™ä¸ªå‰¯ä¸š(ç¼“å­˜æœåŠ¡å™¨)ã€‚

  > ä½†æ˜¯æœ¬èº«ä¸æ”¯æŒç‰¹æ€§æŒºå¤šï¼Œåªèƒ½ç¼“å­˜é™æ€æ–‡ä»¶ã€‚

- 2ã€ä»è¿™äº›åŠŸèƒ½ä¸Šï¼ŒVarinsh å’Œ Squid æ˜¯ä¸“ä¸šçš„ Cache æœåŠ¡ï¼Œè€ŒNginx è¿™äº›æ˜¯ç¬¬ä¸‰æ–¹æ¨¡å—å®Œæˆã€‚

- 3ã€Varnish æœ¬èº«çš„æŠ€æœ¯ä¸Šä¼˜åŠ¿è¦é«˜äº Squid ï¼Œå®ƒé‡‡ç”¨äº†å¯è§†åŒ–é¡µé¢ç¼“å­˜æŠ€æœ¯ã€‚

  > - åœ¨å†…å­˜çš„åˆ©ç”¨ä¸Šï¼ŒVarnis hæ¯” Squid å…·æœ‰ä¼˜åŠ¿ï¼Œæ€§èƒ½è¦æ¯” Squid é«˜ã€‚
  > - è¿˜æœ‰å¼ºå¤§çš„é€šè¿‡ Varnish ç®¡ç†ç«¯å£ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å¿«é€Ÿã€æ‰¹é‡åœ°æ¸…é™¤éƒ¨åˆ†ç¼“å­˜
  > - Varnish æ˜¯å†…å­˜ç¼“å­˜ï¼Œé€Ÿåº¦ä¸€æµï¼Œä½†æ˜¯å†…å­˜ç¼“å­˜ä¹Ÿé™åˆ¶äº†å…¶å®¹é‡ï¼Œç¼“å­˜é¡µé¢å’Œå›¾ç‰‡ä¸€èˆ¬æ˜¯æŒºå¥½çš„ã€‚

- 4ã€Squid çš„ä¼˜åŠ¿åœ¨äºå®Œæ•´çš„åºå¤§çš„ cache æŠ€æœ¯èµ„æ–™ï¼Œå’Œå¾ˆå¤šçš„åº”ç”¨ç”Ÿäº§ç¯å¢ƒã€‚

ğŸš€ å·¥ä½œé€‰æ‹©ï¼š

è¦åš cache æœåŠ¡çš„è¯ï¼Œæˆ‘ä»¬è‚¯å®šæ˜¯è¦é€‰æ‹©ä¸“ä¸šçš„ cache æœåŠ¡ï¼Œä¼˜å…ˆé€‰æ‹©Squid æˆ–è€… Varnish ã€‚

## è¯·è§£é‡Š Nginx å¦‚ä½•å¤„ç† HTTP è¯·æ±‚ï¼Ÿ

- é¦–å…ˆï¼ŒNginx åœ¨å¯åŠ¨æ—¶ï¼Œä¼šè§£æé…ç½®æ–‡ä»¶ï¼Œå¾—åˆ°éœ€è¦ç›‘å¬çš„ç«¯å£ä¸ IP åœ°å€ï¼Œç„¶ååœ¨ Nginx çš„ Master è¿›ç¨‹é‡Œé¢å…ˆåˆå§‹åŒ–å¥½è¿™ä¸ªç›‘æ§çš„Socket(åˆ›å»º S ocketï¼Œè®¾ç½® addrã€reuse ç­‰é€‰é¡¹ï¼Œç»‘å®šåˆ°æŒ‡å®šçš„ ip åœ°å€ç«¯å£ï¼Œå† listen ç›‘å¬)ã€‚

- ç„¶åï¼Œå† fork(ä¸€ä¸ªç°æœ‰è¿›ç¨‹å¯ä»¥è°ƒç”¨ fork å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ã€‚ç”± fork åˆ›å»ºçš„æ–°è¿›ç¨‹è¢«ç§°ä¸ºå­è¿›ç¨‹ )å‡ºå¤šä¸ªå­è¿›ç¨‹å‡ºæ¥ã€‚

- ä¹‹åï¼Œå­è¿›ç¨‹ä¼šç«äº‰ accept æ–°çš„è¿æ¥ã€‚æ­¤æ—¶ï¼Œå®¢æˆ·ç«¯å°±å¯ä»¥å‘ nginx å‘èµ·è¿æ¥äº†ã€‚å½“å®¢æˆ·ç«¯ä¸nginxè¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸ nginx å»ºç«‹å¥½ä¸€ä¸ªè¿æ¥åã€‚æ­¤æ—¶ï¼ŒæŸä¸€ä¸ªå­è¿›ç¨‹ä¼š accept æˆåŠŸï¼Œå¾—åˆ°è¿™ä¸ªå»ºç«‹å¥½çš„è¿æ¥çš„ Socket ï¼Œç„¶ååˆ›å»º nginx å¯¹è¿æ¥çš„å°è£…ï¼Œå³ ngx_connection_t ç»“æ„ä½“ã€‚

- æ¥ç€ï¼Œè®¾ç½®è¯»å†™äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œå¹¶æ·»åŠ è¯»å†™äº‹ä»¶æ¥ä¸å®¢æˆ·ç«¯è¿›è¡Œæ•°æ®çš„äº¤æ¢ã€‚

  > è¿™é‡Œï¼Œè¿˜æ˜¯æœ‰ä¸€äº›é€»è¾‘ï¼Œç»§ç»­åœ¨ [ã€ŒNginx æ˜¯å¦‚ä½•å®ç°é«˜å¹¶å‘çš„ï¼Ÿã€](http://svip.iocoder.cn/Nginx/Interview/#) é—®é¢˜ä¸­æ¥çœ‹ã€‚

- æœ€åï¼ŒNginx æˆ–å®¢æˆ·ç«¯æ¥ä¸»åŠ¨å…³æ‰è¿æ¥ï¼Œåˆ°æ­¤ï¼Œä¸€ä¸ªè¿æ¥å°±å¯¿ç»ˆæ­£å¯äº†ã€‚

ğŸ¦… **Nginx æ˜¯å¦‚ä½•å®ç°é«˜å¹¶å‘çš„ï¼Ÿ**

å¦‚æœä¸€ä¸ª server é‡‡ç”¨ä¸€ä¸ªè¿›ç¨‹(æˆ–è€…çº¿ç¨‹)è´Ÿè´£ä¸€ä¸ªrequestçš„æ–¹å¼ï¼Œé‚£ä¹ˆè¿›ç¨‹æ•°å°±æ˜¯å¹¶å‘æ•°ã€‚é‚£ä¹ˆæ˜¾è€Œæ˜“è§çš„ï¼Œå°±æ˜¯ä¼šæœ‰å¾ˆå¤šè¿›ç¨‹åœ¨ç­‰å¾…ä¸­ã€‚ç­‰ä»€ä¹ˆï¼Ÿæœ€å¤šçš„åº”è¯¥æ˜¯ç­‰å¾…ç½‘ç»œä¼ è¾“ã€‚å…¶ç¼ºç‚¹èƒ–å‹åº”è¯¥ä¹Ÿæ„Ÿè§‰åˆ°äº†ï¼Œæ­¤å¤„ä¸è¿°ã€‚

> æ€è€ƒä¸‹ï¼ŒJava çš„ NIO å’Œ BIO çš„å¯¹æ¯”å“Ÿã€‚

è€Œ Nginx çš„å¼‚æ­¥éé˜»å¡å·¥ä½œæ–¹å¼æ­£æ˜¯åˆ©ç”¨äº†è¿™ç‚¹ç­‰å¾…çš„æ—¶é—´ã€‚åœ¨éœ€è¦ç­‰å¾…çš„æ—¶å€™ï¼Œè¿™äº›è¿›ç¨‹å°±ç©ºé—²å‡ºæ¥å¾…å‘½äº†ã€‚å› æ­¤è¡¨ç°ä¸ºå°‘æ•°å‡ ä¸ªè¿›ç¨‹å°±è§£å†³äº†å¤§é‡çš„å¹¶å‘é—®é¢˜ã€‚

Nginxæ˜¯å¦‚ä½•åˆ©ç”¨çš„å‘¢ï¼Œç®€å•æ¥è¯´ï¼šåŒæ ·çš„ 4 ä¸ªè¿›ç¨‹ï¼Œå¦‚æœé‡‡ç”¨ä¸€ä¸ªè¿›ç¨‹è´Ÿè´£ä¸€ä¸ª request çš„æ–¹å¼ï¼Œé‚£ä¹ˆï¼ŒåŒæ—¶è¿›æ¥ 4 ä¸ª request ä¹‹åï¼Œæ¯ä¸ªè¿›ç¨‹å°±è´Ÿè´£å…¶ä¸­ä¸€ä¸ªï¼Œç›´è‡³ä¼šè¯å…³é—­ã€‚æœŸé—´ï¼Œå¦‚æœæœ‰ç¬¬ 5 ä¸ªrequestè¿›æ¥äº†ã€‚å°±æ— æ³•åŠæ—¶ååº”äº†ï¼Œå› ä¸º 4 ä¸ªè¿›ç¨‹éƒ½æ²¡å¹²å®Œæ´»å‘¢ï¼Œå› æ­¤ï¼Œä¸€èˆ¬æœ‰ä¸ªè°ƒåº¦è¿›ç¨‹ï¼Œæ¯å½“æ–°è¿›æ¥äº†ä¸€ä¸ª request ï¼Œå°±æ–°å¼€ä¸ªè¿›ç¨‹æ¥å¤„ç†ã€‚

> å›æƒ³ä¸‹ï¼ŒBIO æ˜¯ä¸æ˜¯å­˜åœ¨é…±ç´«çš„é—®é¢˜ï¼Ÿå˜»å˜»ã€‚

Nginx ä¸è¿™æ ·ï¼Œæ¯è¿›æ¥ä¸€ä¸ª request ï¼Œä¼šæœ‰ä¸€ä¸ª worker è¿›ç¨‹å»å¤„ç†ã€‚ä½†ä¸æ˜¯å…¨ç¨‹çš„å¤„ç†ï¼Œå¤„ç†åˆ°ä»€ä¹ˆç¨‹åº¦å‘¢ï¼Ÿå¤„ç†åˆ°å¯èƒ½å‘ç”Ÿé˜»å¡çš„åœ°æ–¹ï¼Œæ¯”å¦‚å‘ä¸Šæ¸¸ï¼ˆåç«¯ï¼‰æœåŠ¡å™¨è½¬å‘ request ï¼Œå¹¶ç­‰å¾…è¯·æ±‚è¿”å›ã€‚é‚£ä¹ˆï¼Œè¿™ä¸ªå¤„ç†çš„ worker ä¸ä¼šè¿™ä¹ˆå‚»ç­‰ç€ï¼Œä»–ä¼šåœ¨å‘é€å®Œè¯·æ±‚åï¼Œæ³¨å†Œä¸€ä¸ªäº‹ä»¶ï¼šâ€œå¦‚æœ upstream è¿”å›äº†ï¼Œå‘Šè¯‰æˆ‘ä¸€å£°ï¼Œæˆ‘å†æ¥ç€å¹²â€ã€‚äºæ˜¯ä»–å°±ä¼‘æ¯å»äº†ã€‚æ­¤æ—¶ï¼Œå¦‚æœå†æœ‰ request è¿›æ¥ï¼Œä»–å°±å¯ä»¥å¾ˆå¿«å†æŒ‰è¿™ç§æ–¹å¼å¤„ç†ã€‚è€Œä¸€æ—¦ä¸Šæ¸¸æœåŠ¡å™¨è¿”å›äº†ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶ï¼Œworker æ‰ä¼šæ¥æ¥æ‰‹ï¼Œè¿™ä¸ª request æ‰ä¼šæ¥ç€å¾€ä¸‹èµ°ã€‚

> è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¯´ï¼ŒNginx åŸºäºäº‹ä»¶æ¨¡å‹ã€‚

ç”±äº web server çš„å·¥ä½œæ€§è´¨å†³å®šäº†æ¯ä¸ª request çš„å¤§éƒ¨ä»½ç”Ÿå‘½éƒ½æ˜¯åœ¨ç½‘ç»œä¼ è¾“ä¸­ï¼Œå®é™…ä¸ŠèŠ±è´¹åœ¨ server æœºå™¨ä¸Šçš„æ—¶é—´ç‰‡ä¸å¤šã€‚è¿™æ˜¯å‡ ä¸ªè¿›ç¨‹å°±è§£å†³é«˜å¹¶å‘çš„ç§˜å¯†æ‰€åœ¨ã€‚å³ï¼š

> webserver åˆšå¥½å±äºç½‘ç»œ IO å¯†é›†å‹åº”ç”¨ï¼Œä¸ç®—æ˜¯è®¡ç®—å¯†é›†å‹ã€‚

è€Œæ­£å¦‚å”åº¦æ‰€è¯´çš„

> å¼‚æ­¥ï¼Œéé˜»å¡ï¼Œä½¿ç”¨ epoll ï¼Œå’Œå¤§é‡ç»†èŠ‚å¤„çš„ä¼˜åŒ–ã€‚

ä¹Ÿæ­£æ˜¯ Nginx ä¹‹æ‰€ä»¥ç„¶çš„æŠ€æœ¯åŸºçŸ³ã€‚

ğŸ¦… **ä¸ºä»€ä¹ˆ Nginx ä¸ä½¿ç”¨å¤šçº¿ç¨‹ï¼Ÿ**

Apache: åˆ›å»ºå¤šä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹ï¼Œè€Œæ¯ä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹éƒ½ä¼šä¸ºå…¶åˆ†é… cpu å’Œå†…å­˜ï¼ˆçº¿ç¨‹è¦æ¯”è¿›ç¨‹å°çš„å¤šï¼Œæ‰€ä»¥ worker æ”¯æŒæ¯” perfork é«˜çš„å¹¶å‘ï¼‰ï¼Œå¹¶å‘è¿‡å¤§ä¼šæ¦¨å¹²æœåŠ¡å™¨èµ„æºã€‚

Nginx: é‡‡ç”¨å•çº¿ç¨‹æ¥å¼‚æ­¥éé˜»å¡å¤„ç†è¯·æ±‚ï¼ˆç®¡ç†å‘˜å¯ä»¥é…ç½® Nginx ä¸»è¿›ç¨‹çš„å·¥ä½œè¿›ç¨‹çš„æ•°é‡ï¼‰(epoll)ï¼Œä¸ä¼šä¸ºæ¯ä¸ªè¯·æ±‚åˆ†é… cpu å’Œå†…å­˜èµ„æºï¼ŒèŠ‚çœäº†å¤§é‡èµ„æºï¼ŒåŒæ—¶ä¹Ÿå‡å°‘äº†å¤§é‡çš„ CPU çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚æ‰€ä»¥æ‰ä½¿å¾— Nginx æ”¯æŒæ›´é«˜çš„å¹¶å‘ã€‚

> Nettyã€Redis åŸºæœ¬é‡‡ç”¨ç›¸åŒæ€è·¯ã€‚

## ä»€ä¹ˆæ˜¯åŠ¨æ€èµ„æºã€é™æ€èµ„æºåˆ†ç¦»ï¼Ÿ

åŠ¨æ€èµ„æºã€é™æ€èµ„æºåˆ†ç¦»ï¼Œæ˜¯è®©åŠ¨æ€ç½‘ç«™é‡Œçš„åŠ¨æ€ç½‘é¡µæ ¹æ®ä¸€å®šè§„åˆ™æŠŠä¸å˜çš„èµ„æºå’Œç»å¸¸å˜çš„èµ„æºåŒºåˆ†å¼€æ¥ï¼ŒåŠ¨é™èµ„æºåšå¥½äº†æ‹†åˆ†ä»¥åæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®é™æ€èµ„æºçš„ç‰¹ç‚¹å°†å…¶åšç¼“å­˜æ“ä½œï¼Œè¿™å°±æ˜¯ç½‘ç«™é™æ€åŒ–å¤„ç†çš„æ ¸å¿ƒæ€è·¯ã€‚

åŠ¨æ€èµ„æºã€é™æ€èµ„æºåˆ†ç¦»ç®€å•çš„æ¦‚æ‹¬æ˜¯ï¼šåŠ¨æ€æ–‡ä»¶ä¸é™æ€æ–‡ä»¶çš„åˆ†ç¦»ã€‚

ğŸ¦… **ä¸ºä»€ä¹ˆè¦åšåŠ¨ã€é™åˆ†ç¦»ï¼Ÿ**

åœ¨æˆ‘ä»¬çš„è½¯ä»¶å¼€å‘ä¸­ï¼Œæœ‰äº›è¯·æ±‚æ˜¯éœ€è¦åå°å¤„ç†çš„ï¼ˆå¦‚ï¼š`.jsp`,`.do` ç­‰ç­‰ï¼‰ï¼Œæœ‰äº›è¯·æ±‚æ˜¯ä¸éœ€è¦ç»è¿‡åå°å¤„ç†çš„ï¼ˆå¦‚ï¼šcssã€htmlã€jpgã€js ç­‰ç­‰æ–‡ä»¶ï¼‰ï¼Œè¿™äº›ä¸éœ€è¦ç»è¿‡åå°å¤„ç†çš„æ–‡ä»¶ç§°ä¸ºé™æ€æ–‡ä»¶ï¼Œå¦åˆ™åŠ¨æ€æ–‡ä»¶ã€‚

å› æ­¤æˆ‘ä»¬åå°å¤„ç†å¿½ç•¥é™æ€æ–‡ä»¶ã€‚è¿™ä¼šæœ‰äººåˆè¯´é‚£æˆ‘åå°å¿½ç•¥é™æ€æ–‡ä»¶ä¸å°±å®Œäº†å—ï¼Ÿå½“ç„¶è¿™æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯è¿™æ ·åå°çš„è¯·æ±‚æ¬¡æ•°å°±æ˜æ˜¾å¢å¤šäº†ã€‚åœ¨æˆ‘ä»¬å¯¹èµ„æºçš„å“åº”é€Ÿåº¦æœ‰è¦æ±‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨è¿™ç§åŠ¨é™åˆ†ç¦»çš„ç­–ç•¥å»è§£å†³åŠ¨ã€é™åˆ†ç¦»å°†ç½‘ç«™é™æ€èµ„æºï¼ˆHTMLï¼ŒJavaScriptï¼ŒCSSï¼Œimgç­‰æ–‡ä»¶ï¼‰ä¸åå°åº”ç”¨åˆ†å¼€éƒ¨ç½²ï¼Œæé«˜ç”¨æˆ·è®¿é—®é™æ€ä»£ç çš„é€Ÿåº¦ï¼Œé™ä½å¯¹åå°åº”ç”¨è®¿é—®

è¿™é‡Œæˆ‘ä»¬å°†é™æ€èµ„æºæ”¾åˆ° Nginx ä¸­ï¼ŒåŠ¨æ€èµ„æºè½¬å‘åˆ° Tomcat æœåŠ¡å™¨ä¸­å»ã€‚

ğŸ˜ˆ å½“ç„¶ï¼Œå› ä¸ºç°åœ¨ä¸ƒç‰›ã€é˜¿é‡Œäº‘ç­‰ CDN æœåŠ¡å·²ç»å¾ˆæˆç†Ÿï¼Œä¸»æµçš„åšæ³•ï¼Œæ˜¯æŠŠé™æ€èµ„æºç¼“å­˜åˆ° CDN æœåŠ¡ä¸­ï¼Œä»è€Œæå‡è®¿é—®é€Ÿåº¦ã€‚

- ç›¸æ¯”æœ¬åœ°çš„ Nginx æ¥è¯´ï¼ŒCDN æœåŠ¡å™¨ç”±äºåœ¨å›½å†…æœ‰æ›´å¤šçš„èŠ‚ç‚¹ï¼Œå¯ä»¥å®ç°ç”¨æˆ·çš„å°±è¿‘è®¿é—®ã€‚
- å¹¶ä¸”ï¼ŒCDN æœåŠ¡å¯ä»¥æä¾›æ›´å¤§çš„å¸¦å®½ï¼Œä¸åƒæˆ‘ä»¬è‡ªå·±çš„åº”ç”¨æœåŠ¡ï¼Œæä¾›çš„å¸¦å®½æ˜¯æœ‰é™çš„ã€‚

ğŸ¦… **ä»€ä¹ˆå« CDN æœåŠ¡ï¼Ÿ**

CDN ï¼Œå³å†…å®¹åˆ†å‘ç½‘ç»œã€‚

å…¶ç›®çš„æ˜¯ï¼Œé€šè¿‡åœ¨ç°æœ‰çš„ Internetä¸­ å¢åŠ ä¸€å±‚æ–°çš„ç½‘ç»œæ¶æ„ï¼Œå°†ç½‘ç«™çš„å†…å®¹å‘å¸ƒåˆ°æœ€æ¥è¿‘ç”¨æˆ·çš„ç½‘ç»œè¾¹ç¼˜ï¼Œä½¿ç”¨æˆ·å¯å°±è¿‘å–å¾—æ‰€éœ€çš„å†…å®¹ï¼Œæé«˜ç”¨æˆ·è®¿é—®ç½‘ç«™çš„é€Ÿåº¦ã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œå› ä¸ºç°åœ¨ CDN æœåŠ¡æ¯”è¾ƒå¤§ä¼—ï¼Œæ‰€ä»¥åŸºæœ¬æ‰€æœ‰å…¬å¸éƒ½ä¼šä½¿ç”¨ CDN æœåŠ¡ã€‚

## Nginx æœ‰å“ªäº›è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Ÿ

è´Ÿè½½å‡è¡¡ï¼Œå³æ˜¯ä»£ç†æœåŠ¡å™¨å°†æ¥æ”¶çš„è¯·æ±‚å‡è¡¡çš„åˆ†å‘åˆ°å„æœåŠ¡å™¨ä¸­ã€‚

Nginx é»˜è®¤æä¾›äº† 3 ç§è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼š

- 1ã€è½®è¯¢ï¼ˆé»˜è®¤ï¼‰round_robin

  > æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡å™¨ down æ‰ï¼Œèƒ½è‡ªåŠ¨å‰”é™¤ã€‚

- 2ã€IP å“ˆå¸Œ ip_hash

  > æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—® ip çš„ hash ç»“æœåˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³ session å…±äº«çš„é—®é¢˜ã€‚
  >
  > å½“ç„¶ï¼Œå®é™…åœºæ™¯ä¸‹ï¼Œä¸€èˆ¬ä¸è€ƒè™‘ä½¿ç”¨ ip_hash è§£å†³ session å…±äº«ã€‚

- 3ã€æœ€å°‘è¿æ¥ least_conn

  > ä¸‹ä¸€ä¸ªè¯·æ±‚å°†è¢«åˆ†æ´¾åˆ°æ´»åŠ¨è¿æ¥æ•°é‡æœ€å°‘çš„æœåŠ¡å™¨

é€šè¿‡ Nginx æ’ä»¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¼•å…¥ fairã€url_hash ç­‰è´Ÿè½½å‡è¡¡ç­–ç•¥ã€‚

å¦å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é…ç½®æ¯ä¸€ä¸ªåç«¯èŠ‚ç‚¹åœ¨è´Ÿè½½å‡è¡¡æ—¶çš„å…¶å®ƒé…ç½®ï¼š

```
weight=1; # (weight é»˜è®¤ä¸º1.weightè¶Šå¤§ï¼Œè´Ÿè½½çš„æƒé‡å°±è¶Šå¤§)
down; # (down è¡¨ç¤ºå•å‰çš„serveræš‚æ—¶ä¸å‚ä¸è´Ÿè½½)
backup; # (å…¶å®ƒæ‰€æœ‰çš„ébackupæœºå™¨downæˆ–è€…å¿™çš„æ—¶å€™ï¼Œè¯·æ±‚backupæœºå™¨)
max_fails=1; # å…è®¸è¯·æ±‚å¤±è´¥çš„æ¬¡æ•°é»˜è®¤ä¸º 1 ã€‚å½“è¶…è¿‡æœ€å¤§æ¬¡æ•°æ—¶ï¼Œè¿”å› proxy_next_upstream æ¨¡å—å®šä¹‰çš„é”™è¯¯
fail_timeout=30; # max_fails æ¬¡å¤±è´¥åï¼Œæš‚åœçš„æ—¶é—´
```

è¯¦ç»†çš„ï¼Œå¯ä»¥å†çœ‹çœ‹ [ã€ŠNginx å®˜æ–¹æ–‡æ¡£ â€”â€” ä½¿ç”¨ Nginx ä½œä¸º HTTP è´Ÿè½½å‡è¡¡ã€‹](http://ifeve.com/nginx-http/) æ–‡ç« ã€‚

## Nginx å¦‚ä½•å®ç°åç«¯æœåŠ¡çš„å¥åº·æ£€æŸ¥ï¼Ÿ

å‚è§ [ã€ŠNginx è´Ÿè½½å‡è¡¡ä¸­åç«¯èŠ‚ç‚¹æœåŠ¡å™¨å¥åº·æ£€æŸ¥çš„æ“ä½œæ¢³ç†ã€‹](https://www.cnblogs.com/kevingrace/p/6685698.html) æ–‡ç« ã€‚

- æ–¹å¼ä¸€ï¼Œåˆ©ç”¨ nginx è‡ªå¸¦æ¨¡å— ngx_http_proxy_module å’Œ ngx_http_upstream_module å¯¹åç«¯èŠ‚ç‚¹åšå¥åº·æ£€æŸ¥ã€‚

- æ–¹å¼äºŒï¼Œåˆ©ç”¨ nginx_upstream_check_module æ¨¡å—å¯¹åç«¯èŠ‚ç‚¹åšå¥åº·æ£€æŸ¥ã€‚

  > æ¨èä½¿ç”¨ã€‚

## Nginx å¦‚ä½•å¼€å¯å‹ç¼©ï¼Ÿ

å‚è§ [ã€ŠNginx å¼€å¯ gzip å‹ç¼©çš„é…ç½®è¯¦è§£å’Œå‹ç¼©æ•ˆæœå¯¹æ¯”ã€‹](https://www.daixiaorui.com/read/251.html) æ–‡ç« ã€‚

## 666. å½©è›‹

å¯¹äºå¼€å‘æ¥è¯´ï¼ŒNginx æˆ‘ä»¬ä¸»è¦æŒæ¡ä¼šç”¨ï¼Œæ‰€ä»¥å®é™…é¢è¯•åœºæ™¯ä¸‹ï¼Œé—®çš„ä¹Ÿä¸ä¼šå¤ªæ·±ã€‚

å‚è€ƒä¸æ¨èå¦‚ä¸‹æ–‡ç« ï¼š

- [ã€ŠNginx é¢è¯•ä¸­æœ€å¸¸è§çš„ 18 é“é¢˜ â€”â€” æŠ±ä½›è„šå¿…å¤‡ã€‹](https://segmentfault.com/a/1190000010677483)
- [ã€ŠNginx å¸¸è§é¢è¯•é¢˜ã€‹](https://blog.csdn.net/xal0610/article/details/79531692)
- [ã€ŠNginx è´Ÿè½½å‡è¡¡ç­–ç•¥ã€‹](https://www.jianshu.com/p/4af1940bd251)
- [ã€ŠNginx å¤šè¿›ç¨‹æ¨¡å‹æ˜¯å¦‚ä½•å®ç°é«˜å¹¶å‘çš„ï¼Ÿã€‹](https://www.zhihu.com/question/22062795)



- [é¢è¯•é¢˜](javascript:void(0))







1. [è¯·è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯ Nginx ï¼Ÿ](http://svip.iocoder.cn/Nginx/Interview/#%E8%AF%B7%E8%A7%A3%E9%87%8A%E4%B8%80%E4%B8%8B%E4%BB%80%E4%B9%88%E6%98%AF-Nginx-%EF%BC%9F)
2. [Nginx å¸¸ç”¨å‘½ä»¤ï¼Ÿ](http://svip.iocoder.cn/Nginx/Interview/#Nginx-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%EF%BC%9F)
3. [Nginx å¸¸ç”¨é…ç½®ï¼Ÿ](http://svip.iocoder.cn/Nginx/Interview/#Nginx-%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%EF%BC%9F)
4. [Nginx æœ‰å“ªäº›ä¼˜ç‚¹ï¼Ÿ](http://svip.iocoder.cn/Nginx/Interview/#Nginx-%E6%9C%89%E5%93%AA%E4%BA%9B%E4%BC%98%E7%82%B9%EF%BC%9F)
5. [ä½¿ç”¨â€œåå‘ä»£ç†æœåŠ¡å™¨â€çš„ä¼˜ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ](http://svip.iocoder.cn/Nginx/Interview/#%E4%BD%BF%E7%94%A8%E2%80%9C%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E2%80%9D%E7%9A%84%E4%BC%98%E7%82%B9%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F)
6. [è¯·è§£é‡Š Nginx å¦‚ä½•å¤„ç† HTTP è¯·æ±‚ï¼Ÿ](http://svip.iocoder.cn/Nginx/Interview/#%E8%AF%B7%E8%A7%A3%E9%87%8A-Nginx-%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86-HTTP-%E8%AF%B7%E6%B1%82%EF%BC%9F)
7. [ä»€ä¹ˆæ˜¯åŠ¨æ€èµ„æºã€é™æ€èµ„æºåˆ†ç¦»ï¼Ÿ](http://svip.iocoder.cn/Nginx/Interview/#%E4%BB%80%E4%B9%88%E6%98%AF%E5%8A%A8%E6%80%81%E8%B5%84%E6%BA%90%E3%80%81%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E5%88%86%E7%A6%BB%EF%BC%9F)
8. [Nginx æœ‰å“ªäº›è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Ÿ](http://svip.iocoder.cn/Nginx/Interview/#Nginx-%E6%9C%89%E5%93%AA%E4%BA%9B%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AD%96%E7%95%A5%EF%BC%9F)
9. [Nginx å¦‚ä½•å®ç°åç«¯æœåŠ¡çš„å¥åº·æ£€æŸ¥ï¼Ÿ](http://svip.iocoder.cn/Nginx/Interview/#Nginx-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%81%A5%E5%BA%B7%E6%A3%80%E6%9F%A5%EF%BC%9F)
10. [Nginx å¦‚ä½•å¼€å¯å‹ç¼©ï¼Ÿ](http://svip.iocoder.cn/Nginx/Interview/#Nginx-%E5%A6%82%E4%BD%95%E5%BC%80%E5%90%AF%E5%8E%8B%E7%BC%A9%EF%BC%9F)
11. [666. å½©è›‹](http://svip.iocoder.cn/Nginx/Interview/#666-%E5%BD%A9%E8%9B%8B)

Â© 2019 èŠ‹é“æºç 

[Hexo](http://hexo.io/) Theme [Yilia](https://github.com/litten/hexo-theme-yilia) by Litten

æ€»è®¿å®¢æ•° 88020 æ¬¡

 

&&

 

æ€»è®¿é—®é‡ 575508 æ¬¡


  